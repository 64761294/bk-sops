(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{1194:function(t,e,s){},1448:function(t,e,s){"use strict";s(1194)},600:function(t,e,s){"use strict";s.r(e);s(38),s(49),s(50);var i=s(51),a=s.n(i),n=s(16),r=s.n(n),o=s(5),c=s.n(o),l=s(0),u=s.n(l),d=s(4),m=s.n(d),p=(s(127),s(27),s(81),s(67),s(183),s(37),s(68),s(103),s(82),s(22),s(26),s(80),s(23),s(101),s(39),s(104),s(128),s(185),s(678),s(24),s(43),s(1)),h=s(7),b=s(675),f=s(611),k=s(695),v=s(28),_=s(687),g=s.n(_),w=s(102),y=s(685);function x(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function j(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?x(Object(s),!0).forEach((function(e){c()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var T=[{type:"select",label:p.a.t("所属项目"),key:"selectedProject",loading:!0,placeholder:p.a.t("请选择项目"),list:[],value:""},{type:"dateRange",key:"executeTime",placeholder:p.a.t("选择日期时间范围"),label:p.a.t("提单时间"),value:["",""]},{type:"input",key:"creator",label:p.a.t("提单人"),placeholder:p.a.t("请输入提单人"),value:""},{type:"select",label:p.a.t("状态"),key:"statusSync",loading:!1,placeholder:p.a.t("请选择状态"),list:[{value:"submitted",name:p.a.t("未认领")},{value:"claimed",name:p.a.t("已认领")},{value:"executed",name:p.a.t("已执行")},{value:"finished",name:p.a.t("完成")}],value:""}],C=[{id:"project",label:p.a.t("所属项目"),width:160},{id:"id",label:p.a.t("任务ID"),width:110},{id:"name",label:p.a.t("任务名称"),disabled:!0,min_width:200},{id:"create_time",label:p.a.t("提单时间"),isShow:!0,width:200},{id:"claim_time",label:p.a.t("认领时间"),width:200},{id:"creator",label:p.a.t("提单人"),width:120},{id:"claimant",label:p.a.t("认领人"),width:120},{id:"claim_status",label:p.a.t("认领状态"),width:120},{id:"excute_status",label:p.a.t("执行状态"),width:120}],P={name:"functionHome",components:{Skeleton:b.a,AdvanceSearchForm:k.a,NoData:f.a},mixins:[w.a,y.a],props:["project_id","app_id"],data:function(){var t=this,e=this.$route.query,s=e.page,i=void 0===s?1:s,a=e.limit,n=void 0===a?15:a,r=e.selectedProject,o=void 0===r?"":r,c=e.executeTime,l=void 0===c?"":c,d=e.creator,m=void 0===d?"":d,h=e.statusSync,b=void 0===h?"":h,f=e.keyword,k=void 0===f?"":f;return{firstLoading:!0,listLoading:!1,functorSync:0,searchForm:T.map(function(e){return u()(this,t),this.$route.query[e.key]&&(Array.isArray(e.value)?e.value=this.$route.query[e.key].split(","):e.value="selectedProject"===e.key?Number(this.$route.query[e.key]):this.$route.query[e.key]),e}.bind(this)),isSearchFormOpen:T.some(function(e){return u()(this,t),this.$route.query[e.key]}.bind(this)),isShowNewTaskDialog:!1,functorBasicInfoLoading:!0,functorList:[],executeStatus:[],business:{list:[],loading:!1,id:"",searchable:!0,empty:!1},template:{list:[{name:p.a.t("项目流程"),children:[]},{name:p.a.t("公共流程"),children:[]}],loading:!1,searchable:!0,id:"",name:"",project:{},empty:!1,disabled:!1},isCommonTemplate:!1,isAutoRedraw:!1,autoRedrawTimer:null,status:void 0,functorCategory:[],requestData:{selectedProject:o,creator:m,statusSync:b,executeTime:l?l.split(","):["",""],taskName:k},pagination:{current:Number(i),count:0,limit:Number(n),"limit-list":[15,30,50,100]},tableFields:C,setting:{fieldList:C,selectedFields:C.slice(0),size:"small"},permissionLoading:!1,tplAction:[],hasCreateTaskPerm:!0}},computed:j(j({},Object(h.e)({categorys:function(t){return u()(this,void 0),t.categorys}.bind(void 0),permissionMeta:function(t){return u()(this,void 0),t.permissionMeta}.bind(void 0)})),Object(h.e)("project",{timeZone:function(t){return u()(this,void 0),t.timezone}.bind(void 0)})),created:function(){var t=this;return r()(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getFields(),t.loadFunctionTask(),t.onSearchInput=v.a.debounce(t.searchInputhandler,500),e.next=5,t.getProjectList();case 5:t.firstLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.clearAutoRedraw()},methods:j(j(j(j(j(j({},Object(h.b)(["queryUserPermission"])),Object(h.b)("functionTask/",["loadFunctionTaskList"])),Object(h.b)("templateList/",["loadTemplateList"])),Object(h.b)("project/",["loadUserProjectList"])),Object(h.d)("atomForm/",["clearAtomForm"])),{},{loadFunctionTask:function(){var t=this;return r()(m.a.mark((function e(){var s,i,a,n,r,o,c,l,d,p,h=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.listLoading=!0,e.prev=1,s=t.requestData,i=s.selectedProject,a=s.executeTime,n=s.creator,r=s.statusSync,o=s.taskName,c={limit:t.pagination.limit,offset:(t.pagination.current-1)*t.pagination.limit,task__pipeline_instance__name__contains:o||void 0,creator:n||void 0,task__project__id:i||void 0,status:r||void 0},a[0]&&a[1]&&(t.common?(c.pipeline_template__start_time__gte=g()(a[0]).format("YYYY-MM-DD"),c.pipeline_template__start_time__lte=g()(a[1]).add("1","d").format("YYYY-MM-DD")):(c.create_time__gte=g.a.tz(a[0],t.timeZone).format("YYYY-MM-DD"),c.create_time__lte=g.a.tz(a[1],t.timeZone).add("1","d").format("YYYY-MM-DD"))),e.next=7,t.loadFunctionTaskList(c);case 7:l=e.sent,d=l.objects,p=l.objects.map(function(t){return u()(this,h),t.task}.bind(this)),t.functorList=d,t.pagination.count=l.meta.total_count,t.getExecuteStatus("executeStatus",p),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.log(e.t0);case 18:return e.prev=18,t.listLoading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[1,15,18,21]])})))()},getFields:function(){var t=this,e=localStorage.getItem("FunctionList");if(e){var s=JSON.parse(e),i=s.fieldList,a=s.size;this.setting.size=a,this.setting.selectedFields=this.tableFields.slice(0).filter(function(e){return u()(this,t),i.includes(e.id)}.bind(this))}},handleSettingChange:function(t){var e=this,s=t.fields,i=t.size;this.setting.size=i,this.setting.selectedFields=s;var a=s.map(function(t){return u()(this,e),t.id}.bind(this));localStorage.setItem("FunctionList",JSON.stringify({fieldList:a,size:i}))},onPageChange:function(t){this.pagination.current=t,this.updateUrl(),this.loadFunctionTask(),this.onOpenAutoRedraw()},onPageLimitChange:function(t){this.pagination.limit=t,this.pagination.current=1,this.updateUrl(),this.loadFunctionTask(),this.onOpenAutoRedraw()},updateUrl:function(){var t=this,e=this.pagination,s=e.current,i=e.limit,a=this.requestData,n=a.selectedProject,r=a.executeTime,o=a.creator,c=a.statusSync,l=a.taskName,d={limit:i,selectedProject:n,creator:o,statusSync:c,page:s,executeTime:r.every(function(e){return u()(this,t),e}.bind(this))?r.join(","):"",keyword:l},m={};Object.keys(d).forEach(function(e){u()(this,t);var s=d[e];(s||0===s||!1===s)&&(m[e]=s)}.bind(this)),this.$router.push({name:"functionHome",query:m})},searchInputhandler:function(t){this.requestData.taskName=t,this.pagination.current=1,this.loadFunctionTask()},statusMethod:function(t,e){return"finished"===t?p.a.t("完成"):"submitted"===t?p.a.t("未认领"):"rejected"===t?p.a.t("已驳回"):e},statusClass:function(t){var e;switch(t){case"submitted":e="common-icon-flag-circle default";break;case"claimed":e="common-icon-flag-circle success";break;case"executed":e="common-icon-dark-circle-ellipsis primary";break;case"rejected":e="common-icon-dark-circle-close";break;case"finished":e="bk-icon icon-check-circle-shape";break;default:e=""}return e},onCreateTask:function(){this.isShowNewTaskDialog=!0},getProjectList:function(){var t=this;return r()(m.a.mark((function e(){var s,i,a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.business.loading=!0,e.prev=1,e.next=4,t.loadUserProjectList({limit:0});case 4:s=e.sent,t.business.list=s.objects,(i=t.searchForm.find(function(t){return u()(this,a),"selectedProject"===t.key}.bind(this))).list=t.business.list.map(function(t){return u()(this,a),{name:t.name,value:t.id}}.bind(this)),i.loading=!1,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.prev=14,t.business.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})))()},getTemplateList:function(){var t=this;return r()(m.a.mark((function e(){var s=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.template.loading=!0,e.prev=1,e.next=4,Promise.all([t.loadTemplateList({project__id:t.business.id}),t.loadTemplateList({common:1})]).then(function(e){u()(this,s),t.template.list[0].children=e[0].objects,t.template.list[1].children=e[1].objects,t.clearAtomForm()}.bind(this));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:return e.prev=9,t.template.loading=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[1,6,9,12]])})))()},onSelectedBusiness:function(t){var e=this,s=this.business.list.find(function(s){return u()(this,e),s.id===t}.bind(this));this.business.id=t,this.business.name=s.name,this.business.auth_actions=s.auth_actions,this.getTemplateList(),this.business.empty=!1,this.template.id="",this.template.name="",this.template.project={},this.template.disabled=!1,this.hasCreateTaskPerm=!0},onSelectedTemplate:function(t){var e,s,i,a=this,n=this.template.list,r="";void 0!==t&&(n.some(function(n){var o=this;return u()(this,a),n.children.some(function(a){if(u()(this,o),a.id===t)return r=a.resource_uri,e=a.name,s=a.project,i=a.auth_actions,!0}.bind(this))}.bind(this)),this.isCommonTemplate=!1,-1!==r.search("common_template")&&(this.isCommonTemplate=!0),this.template.id=t,this.template.name=e,this.template.project=s,this.template.empty=!1,this.tplAction=i,this.checkCreateTaskPerm())},checkCreateTaskPerm:function(){var t=this;return r()(m.a.mark((function e(){var s,i,a,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCommonTemplate){e.next=19;break}return e.prev=1,t.permissionLoading=!0,s=t.permissionMeta.system.find(function(t){return u()(this,n),"bk_sops"===t.id}.bind(this)),i={action:"common_flow_create_task",resources:[{system:s.id,type:"project",id:t.business.id,attributes:{}},{system:s.id,type:"common_flow",id:t.template.id,attributes:{}}]},e.next=7,t.queryUserPermission(i);case 7:a=e.sent,t.hasCreateTaskPerm=a.data.is_allow,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.prev=14,t.permissionLoading=!1,e.finish(14);case 17:e.next=20;break;case 19:t.hasCreateTaskPerm=t.hasPermission(["flow_create_task"],t.tplAction);case 20:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})))()},applyCreateTaskPerm:function(){var t=[],e=[],s={};this.isCommonTemplate?(t=["common_flow_create_task"],e=[].concat(a()(this.tplAction),a()(this.business.auth_actions)),s={common_flow:[{id:this.template.id,name:this.template.name}],project:[{id:this.business.id,name:this.business.name}]}):(t=["flow_create_task"],e=a()(this.tplAction),s={flow:[{id:this.template.id,name:this.template.name}],project:[{id:this.template.project.id,name:this.template.project.name}]}),this.applyForPermission(t,e,s)},onConfirmlNewTask:function(){""!==this.business.id?""!==this.template.id?this.permissionLoading||(this.hasCreateTaskPerm?this.isCommonTemplate?this.$router.push({name:"functionTemplateStep",params:{project_id:this.business.id,step:"selectnode"},query:{template_id:this.template.id,common:1,entrance:"function"}}):this.$router.push({name:"functionTemplateStep",params:{project_id:this.business.id,step:"selectnode"},query:{template_id:this.template.id,entrance:"function"}}):this.applyCreateTaskPerm()):this.template.empty=!0:this.business.empty=!0},onCancelNewTask:function(){this.onClearTemplate(),this.onClearBusiness(),this.isShowNewTaskDialog=!1,this.business.empty=!1,this.template.empty=!1,this.hasCreateTaskPerm=!0},onClearTemplate:function(){this.template.id="",this.template.name="",this.template.project={}},onClearBusiness:function(){this.business.id="",this.business.auth_actions=[],this.template.id="",this.template.name="",this.template.project={},this.template.disabled=!0},onTaskPermissonCheck:function(t,e){var s={task:[{id:e.task.id,name:e.task.name}],project:[{id:e.task.project.id,name:e.task.project.name}]};this.applyForPermission(t,e.auth_actions,s)},onSearchFormSubmit:function(t){this.requestData=Object.assign({},this.requestData,t),this.pagination.current=1,this.updateUrl(),this.loadFunctionTask()},onAutoRedrawChange:function(t){if(t)return this.onOpenAutoRedraw();this.clearAutoRedraw()},onOpenAutoRedraw:function(){var t=this;if(!this.isAutoRedraw)return this.clearAutoRedraw();clearTimeout(this.autoRedrawTimer),this.autoRedrawTimer=setTimeout(function(){u()(this,t),this.loadFunctionTask(),this.onOpenAutoRedraw()}.bind(this),15e3)},clearAutoRedraw:function(){clearTimeout(this.autoRedrawTimer),this.autoRedrawTimer=null,this.isAutoRedraw=!1}})},S=(s(1448),s(9)),O=Object(S.a)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"functor-container"},[s("skeleton",{attrs:{loading:t.firstLoading,loader:"taskList"}},[s("div",{staticClass:"list-wrapper"},[s("advance-search-form",{attrs:{id:"functionList",open:t.isSearchFormOpen,"search-config":{placeholder:t.$t("请输入任务名称")},"search-form":t.searchForm},on:{onSearchInput:t.onSearchInput,submit:t.onSearchFormSubmit},scopedSlots:t._u([{key:"operation",fn:function(){return[s("bk-button",{staticStyle:{"min-width":"120px"},attrs:{theme:"primary"},on:{click:t.onCreateTask}},[t._v("\n                        "+t._s(t.$t("新建"))+"\n                    ")])]},proxy:!0},{key:"search-extend",fn:function(){return[s("span",{staticClass:"auto-redraw",on:{click:function(t){t.stopPropagation()}}},[s("bk-checkbox",{on:{change:t.onAutoRedrawChange},model:{value:t.isAutoRedraw,callback:function(e){t.isAutoRedraw=e},expression:"isAutoRedraw"}},[t._v(t._s(t.$t("实时刷新")))])],1)]},proxy:!0}])}),t._v(" "),s("div",{staticClass:"functor-table-content"},[s("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.firstLoading&&t.listLoading,opacity:1,zIndex:100},expression:"{ isLoading: firstLoading && listLoading, opacity: 1, zIndex: 100 }"}],attrs:{data:t.functorList,pagination:t.pagination,size:t.setting.size},on:{"page-change":t.onPageChange,"page-limit-change":t.onPageLimitChange}},[t._l(t.setting.selectedFields,(function(e){return s("bk-table-column",{key:e.id,attrs:{label:e.label,prop:e.id,width:e.width,"min-width":e.min_width},scopedSlots:t._u([{key:"default",fn:function(i){return["project"===e.id?s("div",[s("span",{attrs:{title:i.row.task.project.name}},[t._v(t._s(i.row.task.project.name))])]):"name"===e.id?s("div",[t.hasPermission(["task_view"],i.row.auth_actions)?s("router-link",{staticClass:"task-name",attrs:{title:i.row.task.name,to:{name:"functionTaskExecute",params:{project_id:i.row.task.project.id},query:{instance_id:i.row.task.id}}}},[t._v("\n                                    "+t._s(i.row.task.name)+"\n                                ")]):s("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",attrs:{title:i.row.task.name},on:{click:function(e){return t.onTaskPermissonCheck(["task_view"],i.row)}}},[t._v("\n                                    "+t._s(i.row.task.name)+"\n                                ")])],1):"claim_status"===e.id?s("div",[s("span",{class:t.statusClass(i.row.status)}),t._v("\n                                "+t._s(t.statusMethod(i.row.status,i.row.status_name))+"\n                            ")]):"excute_status"===e.id?s("div",{staticClass:"task-status"},[s("span",{class:t.executeStatus[i.$index]&&t.executeStatus[i.$index].cls}),t._v(" "),t.executeStatus[i.$index]?s("span",{staticClass:"task-status-text"},[t._v(t._s(t.executeStatus[i.$index].text))]):t._e()]):[s("span",{attrs:{title:i.row[e.id]||"--"}},[t._v(t._s(i.row[e.id]||"--"))])]]}}],null,!0)})})),t._v(" "),s("bk-table-column",{attrs:{label:t.$t("操作"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return["submitted"===e.row.status?[t.hasPermission(["task_claim"],e.row.auth_actions)?s("router-link",{staticClass:"functor-operation-btn",attrs:{to:{name:"functionTaskExecute",params:{project_id:e.row.task.project.id},query:{instance_id:e.row.task.id}}}},[t._v("\n                                    "+t._s(t.$t("认领"))+"\n                                ")]):s("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",on:{click:function(s){return t.onTaskPermissonCheck(["task_claim"],e.row)}}},[t._v("\n                                    "+t._s(t.$t("认领"))+"\n                                ")])]:[t.hasPermission(["task_view"],e.row.auth_actions)?s("router-link",{staticClass:"functor-operation-btn",attrs:{to:{name:"functionTaskExecute",params:{project_id:e.row.task.project.id},query:{instance_id:e.row.task.id}}}},[t._v("\n                                    "+t._s(t.$t("查看"))+"\n                                ")]):s("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",on:{click:function(s){return t.onTaskPermissonCheck(["task_view"],e.row)}}},[t._v("\n                                    "+t._s(t.$t("查看"))+"\n                                ")])]]}}])}),t._v(" "),s("bk-table-column",{attrs:{type:"setting"}},[s("bk-table-setting-content",{attrs:{fields:t.setting.fieldList,selected:t.setting.selectedFields,size:t.setting.size},on:{"setting-change":t.handleSettingChange}})],1),t._v(" "),s("div",{staticClass:"empty-data",attrs:{slot:"empty"},slot:"empty"},[s("NoData",{attrs:{message:t.$t("无数据")}})],1)],2)],1)],1)]),t._v(" "),s("bk-dialog",{attrs:{width:"600","ext-cls":"common-dialog",theme:"primary","mask-close":!1,"header-position":"left",title:t.$t("新建"),value:t.isShowNewTaskDialog},on:{confirm:t.onConfirmlNewTask,cancel:t.onCancelNewTask}},[s("div",{staticClass:"create-task-content"},[s("div",{staticClass:"common-form-item"},[s("label",[t._v(t._s(t.$t("选择项目")))]),t._v(" "),s("div",{staticClass:"common-form-content"},[s("bk-select",{staticClass:"bk-select-inline",attrs:{"popover-width":430,searchable:!0,"is-loading":t.business.loading,placeholder:t.$t("请选择"),clearable:!0},on:{clear:t.onClearBusiness,selected:t.onSelectedBusiness},model:{value:t.business.id,callback:function(e){t.$set(t.business,"id",e)},expression:"business.id"}},t._l(t.business.list,(function(t,e){return s("bk-option",{key:e,attrs:{id:t.id,name:t.name}})})),1),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.business.empty,expression:"business.empty"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.$t("选择项目")))])],1)]),t._v(" "),s("div",{staticClass:"common-form-item"},[s("label",[t._v(t._s(t.$t("选择模板")))]),t._v(" "),s("div",{staticClass:"common-form-content"},[s("bk-select",{staticClass:"bk-select-inline",attrs:{"popover-width":260,"is-loading":t.business.loading,searchable:t.template.searchable,placeholder:t.$t("请选择"),clearable:!0,disabled:t.template.disabled},on:{selected:t.onSelectedTemplate,clear:t.onClearTemplate},model:{value:t.template.id,callback:function(e){t.$set(t.template,"id",e)},expression:"template.id"}},t._l(t.template.list,(function(e,i){return s("bk-option-group",{key:i,attrs:{name:e.name}},t._l(e.children,(function(t){return s("bk-option",{key:t.id,attrs:{id:t.id,name:t.name}})})),1)})),1),t._v(" "),s("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{width:400,placement:"top",content:t.$t("如果未找到模板，请联系项目运维在流程模板的使用权限中对你或所有职能化人员授予“新建任务权限”")},expression:"{\n                            width: 400,\n                            placement: 'top',\n                            content: $t('如果未找到模板，请联系项目运维在流程模板的使用权限中对你或所有职能化人员授予“新建任务权限”') }"}],staticClass:"common-icon-info template-selector-tips"}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.template.empty,expression:"template.empty"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.$t("选择模板")))])],1)])]),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!t.hasCreateTaskPerm},expression:"{ active: !hasCreateTaskPerm }"}],class:{"btn-permission-disable":!t.hasCreateTaskPerm},attrs:{theme:"primary",loading:t.permissionLoading},on:{click:t.onConfirmlNewTask}},[t._v("\n                "+t._s(t.$t("确认"))+"\n            ")]),t._v(" "),s("bk-button",{attrs:{theme:"default"},on:{click:t.onCancelNewTask}},[t._v(t._s(t.$t("取消")))])],1)])],1)}),[],!1,null,"398ddcdd",null);e.default=O.exports},678:function(t,e,s){"use strict";var i=s(138),a=s(17),n=s(45),r=s(688),o=s(139);i("search",(function(t,e,s){return[function(e){var s=n(this),i=null==e?void 0:e[t];return void 0!==i?i.call(e,s):new RegExp(e)[t](String(s))},function(t){var i=s(e,this,t);if(i.done)return i.value;var n=a(this),c=String(t),l=n.lastIndex;r(l,0)||(n.lastIndex=0);var u=o(n,c);return r(n.lastIndex,l)||(n.lastIndex=l),null===u?-1:u.index}]}))},685:function(t,e,s){"use strict";s(26),s(38),s(37),s(49),s(22),s(50);var i=s(16),a=s.n(i),n=s(0),r=s.n(n),o=s(5),c=s.n(o),l=s(4),u=s.n(l),d=(s(127),s(184),s(7)),m=s(1);function p(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function h(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?p(Object(s),!0).forEach((function(e){c()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var b={methods:h(h({},Object(d.b)("task/",["getInstanceStatus"])),{},{getExecuteStatus:function(t,e){var s=this;this[t]=e.map(function(e,i){r()(this,s);var a={};return e.is_expired?(a.cls="expired bk-icon icon-clock-shape",a.text=m.a.t("已过期")):e.is_finished?(a.cls="finished bk-icon icon-check-circle-shape",a.text=m.a.t("完成")):e.is_revoked?(a.cls="revoke common-icon-dark-circle-shape",a.text=m.a.t("撤销")):e.is_started?(a.cls="loading common-icon-loading",this.getExecuteDetail(t,e,i)):(a.cls="created common-icon-dark-circle-shape",a.text=m.a.t("未执行")),a}.bind(this))},getExecuteDetail:function(t,e,s){var i=this;return a()(u.a.mark((function a(){var n,r,o,c;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n={instance_id:e.id,project_id:e.project.id},a.prev=1,a.next=4,i.getInstanceStatus(n);case 4:if(!(r=a.sent).result){a.next=28;break}o=r.data.state,c={},a.t0=o,a.next="RUNNING"===a.t0||"BLOCKED"===a.t0?11:"READY"===a.t0?14:"SUSPENDED"===a.t0?17:"NODE_SUSPENDED"===a.t0?20:"FAILED"===a.t0?23:26;break;case 11:return c.cls="running common-icon-dark-circle-ellipsis",c.text=m.a.t("执行中"),a.abrupt("break",27);case 14:return c.cls="running common-icon-dark-circle-ellipsis",c.text=m.a.t("排队中"),a.abrupt("break",27);case 17:return c.cls="execute common-icon-dark-circle-pause",c.text=m.a.t("暂停"),a.abrupt("break",27);case 20:return c.cls="execute",c.text=m.a.t("节点暂停"),a.abrupt("break",27);case 23:return c.cls="failed common-icon-dark-circle-close",c.text=m.a.t("失败"),a.abrupt("break",27);case 26:c.text=m.a.t("未知");case 27:i[t].splice(s,1,c);case 28:a.next=33;break;case 30:a.prev=30,a.t1=a.catch(1),console.log(a.t1);case 33:case"end":return a.stop()}}),a,null,[[1,30]])})))()}})};e.a=b},688:function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}}}]);