(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1193:function(t,e,a){},1447:function(t,e,a){"use strict";a(1193)},599:function(t,e,a){"use strict";a.r(e);a(26),a(38),a(37),a(49),a(22),a(50);var n=a(16),i=a.n(n),s=a(5),r=a.n(s),o=a(4),c=a.n(o),l=a(1),u=a(7),d=a(102);function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){r()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var _={name:"SourceSync",components:{NoData:a(611).a},mixins:[d.a],props:{hasEditPerm:Boolean,editPermLoading:Boolean},data:function(){return{list:[],currentPage:1,totalPage:1,countPerPage:15,totalCount:0,listLoading:!0,pending:!1,isDetailDialogShow:!1,detail:"",i18n:{manual:l.a.t("手动"),auto:l.a.t("自动")}}},created:function(){this.getSyncTask()},methods:v(v({},Object(u.b)("manage",["loadSyncTask","createSyncTask"])),{},{getSyncTask:function(){var t=this;return i()(c.a.mark((function e(){var a,n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={limit:t.countPerPage,offset:(t.currentPage-1)*t.countPerPage},e.prev=1,t.listLoading=!0,e.next=5,t.loadSyncTask(a);case 5:n=e.sent,t.list=n.objects,t.totalCount=n.meta.total_count,i=Math.ceil(t.totalCount/t.countPerPage),t.totalPage=i||1,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:return e.prev=15,t.listLoading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})))()},onTaskSyncClick:function(){var t=this;return i()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.pending){e.next=3;break}return e.abrupt("return");case 3:return t.pending=!0,e.next=6,t.createSyncTask();case 6:t.getSyncTask(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.prev=12,t.pending=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})))()},getStatusCls:function(t){return"RUNNING"===t?"running common-icon-dark-circle-ellipsis":"FAILED"===t?"failed common-icon-dark-circle-close":"finished bk-icon icon-check-circle-shape"},onViewDetailClick:function(t){this.detail=t.details,this.isDetailDialogShow=!0},onPageChange:function(t){this.currentPage=t,this.getSyncTask()},applyEditPerm:function(){this.editPermLoading||this.applyForPermission(["admin_edit"])}})},g=(a(1447),a(9)),h=Object(g.a)(_,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"source-manage"},[t.hasEditPerm?a("bk-button",{attrs:{theme:"primary",loading:t.pending},on:{click:t.onTaskSyncClick}},[t._v("\n        "+t._s(t.$t("同步到本地缓存"))+"\n    ")]):a("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!0},expression:"{ active: true }"}],staticClass:"btn-permission-disable",attrs:{theme:"primary"},on:{click:t.applyEditPerm}},[t._v("\n        "+t._s(t.$t("同步到本地缓存"))+"\n    ")]),t._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.listLoading,opacity:1,zIndex:100},expression:"{ isLoading: listLoading, opacity: 1, zIndex: 100 }"}],staticClass:"table-container"},[a("table",{staticClass:"sync-table"},[a("thead",[a("tr",[a("th",{staticStyle:{padding:"12px 30px"},attrs:{width:"10%"}},[t._v("ID")]),t._v(" "),a("th",{attrs:{width:"25%"}},[t._v(t._s(t.$t("开始时间")))]),t._v(" "),a("th",{attrs:{width:"25%"}},[t._v(t._s(t.$t("结束时间")))]),t._v(" "),a("th",{attrs:{width:"10%"}},[t._v(t._s(t.$t("操作人")))]),t._v(" "),a("th",{attrs:{width:"10%"}},[t._v(t._s(t.$t("状态")))]),t._v(" "),a("th",{attrs:{width:"10%"}},[t._v(t._s(t.$t("触发方式")))]),t._v(" "),a("th",{attrs:{width:"10%"}},[t._v(t._s(t.$t("操作")))])])]),t._v(" "),a("tbody",[t._l(t.list,(function(e){return a("tr",{key:e.id},[a("td",{staticStyle:{padding:"12px 30px"}},[t._v(t._s(e.id))]),t._v(" "),a("td",[t._v(t._s(e.start_time||"--"))]),t._v(" "),a("td",[t._v(t._s(e.finish_time||"--"))]),t._v(" "),a("td",[t._v(t._s(e.creator))]),t._v(" "),a("td",[a("div",{staticClass:"task-status"},[a("i",{class:t.getStatusCls(e.status)}),t._v("\n                            "+t._s(e.status_display)+"\n                        ")])]),t._v(" "),a("td",[t._v(t._s(t.i18n[e.create_method]))]),t._v(" "),a("td",[a("bk-button",{staticClass:"view-detail",attrs:{theme:"default",size:"small"},on:{click:function(a){return t.onViewDetailClick(e)}}},[t._v("\n                            "+t._s(t.$t("查看详情"))+"\n                        ")])],1)])})),t._v(" "),0===t.list.length?a("tr",[a("td",{staticClass:"empty-data",attrs:{colspan:"7"}},[a("no-data")],1)]):t._e()],2)]),t._v(" "),t.totalPage>1?a("div",{staticClass:"panagation"},[a("div",{staticClass:"page-info"},[a("span",[t._v(" "+t._s(t.$t("共"))+" "+t._s(t.totalCount)+" "+t._s(t.$t("条记录"))+t._s(t.$t("，"))+" "+t._s(t.$t("当前第"))+" "+t._s(t.currentPage)+" "+t._s(t.$t("页")))])]),t._v(" "),a("bk-pagination",{attrs:{current:t.currentPage,count:t.totalCount,limit:15},on:{"update:current":function(e){t.currentPage=e},change:t.onPageChange}})],1):t._e()]),t._v(" "),t.isDetailDialogShow?a("bk-dialog",{attrs:{width:"800",padding:"20px","ext-cls":"common-dialog","header-position":"left",title:t.$t("详细信息"),"mask-close":!1,value:t.isDetailDialogShow},on:{cancel:function(e){t.isDetailDialogShow=!1}}},[a("div",{staticClass:"detail-content",attrs:{slot:"content"},slot:"content"},[a("pre",[t._v(t._s(t.detail))])]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})]):t._e()],1)}),[],!1,null,"3d2db4ac",null);e.default=h.exports},611:function(t,e,a){"use strict";var n={name:"NoData",props:{message:{type:String,default:function(){return""}}}},i=(a(634),a(9)),s=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"no-data-wrapper"},[a("div",{staticClass:"no-data"},[a("i",{staticClass:"common-icon-no-data"}),t._v(" "),a("p",{staticClass:"no-data-wording"},[t._t("default",(function(){return[t._v(t._s(t.message||t.$t("无数据")))]}))],2)])])}),[],!1,null,"03c0cb01",null);e.a=s.exports},625:function(t,e,a){},634:function(t,e,a){"use strict";a(625)}}]);