(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1035:function(e,t,i){},1036:function(e,t,i){},1248:function(e,t,i){"use strict";i(1035)},1249:function(e,t,i){"use strict";i(1036)},575:function(e,t,i){"use strict";i.r(t);i(38),i(49),i(50);var a=i(16),n=i.n(a),o=i(5),s=i.n(o),r=i(0),l=i.n(r),c=i(4),p=i.n(c),u=(i(67),i(127),i(27),i(81),i(23),i(82),i(37),i(183),i(68),i(103),i(80),i(43),i(22),i(26),i(24),i(1)),d=i(7),m=i(6),h=i(28),f=i(675),g=i(1217),v=i(1218),b=i(611),_=i(102),w=i(695),k=i(687),y=i.n(k),x={name:"ListPageTipsTitle",components:{NotifyInfo:i(996).a},props:{num:{type:Number,default:0}},data:function(){return{showDetail:!0}},computed:{content:function(){return this.num+u.a.t(" 个流程涉及到子流程的更新，请及时处理。")}},methods:{onViewClick:function(){this.$emit("viewClick")}}},C=(i(1248),i(9)),L=Object(C.a)(x,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"title-area"},[e.num>0?i("notify-info",{staticClass:"tpl-update-message",attrs:{show:e.showDetail,theme:"warning",content:e.content},on:{"update:show":function(t){e.showDetail=t}},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("bk-button",{attrs:{text:!0,size:"small","ext-cls":"close-notify-btn"},on:{click:function(t){e.showDetail=!1}}},[i("i",{staticClass:"common-icon common-icon-close"})])]},proxy:!0}],null,!1,2617125390)},[e._v("\n        "+e._s(e.content)+"\n        "),i("span",{staticClass:"view-btn",on:{click:e.onViewClick}},[e._v(e._s(e.$t("立即查看")))])]):e._e()],1)}),[],!1,null,"d3b4d2fe",null).exports;function j(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?j(Object(i),!0).forEach((function(t){s()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var T=u.a.t("模板分类即将下线，建议使用标签"),D=[{type:"select",key:"label_ids",multiple:!0,label:u.a.t("标签"),placeholder:u.a.t("请选择标签"),list:[],value:[]},{type:"dateRange",key:"queryTime",placeholder:u.a.t("选择日期时间范围"),label:u.a.t("更新时间"),value:["",""]},{type:"select",label:u.a.t("子流程更新"),key:"subprocessUpdateVal",placeholder:u.a.t("请选择"),list:[{value:1,name:u.a.t("是")},{value:-1,name:u.a.t("否")},{value:0,name:u.a.t("无子流程")}],value:""},{type:"input",key:"creator",label:u.a.t("创建人"),placeholder:u.a.t("请输入创建人"),value:""},{type:"select",label:u.a.t("分类"),key:"category",loading:!1,placeholder:u.a.t("请选择分类"),tips:T,list:[],value:""}],P=[{id:"id",label:u.a.t("ID"),width:80},{id:"name",label:u.a.t("流程名称"),disabled:!0,min_width:400},{id:"label",label:u.a.t("标签"),min_width:300},{id:"create_time",label:u.a.t("创建时间"),sortable:"custom",width:200},{id:"edit_time",label:u.a.t("更新时间"),sortable:"custom",width:200},{id:"subprocess_has_update",label:u.a.t("子流程更新"),width:180},{id:"category_name",label:u.a.t("分类"),min_width:180},{id:"creator_name",label:u.a.t("创建人"),width:160},{id:"editor_name",label:u.a.t("更新人"),width:160}],I={name:"TemplateList",components:{Skeleton:f.a,ImportTemplateDialog:g.a,ExportTemplateDialog:v.a,ListPageTipsTitle:L,AdvanceSearchForm:w.a,NoData:b.a},mixins:[_.a],props:{project_id:[String,Number],page:[String,Number],limit:[String,Number]},data:function(){var e=this,t=this.$route.query,i=t.page,a=void 0===i?1:i,n=t.limit,o=void 0===n?15:n,s=t.category,r=void 0===s?"":s,c=t.queryTime,p=void 0===c?"":c,u=t.subprocessUpdateVal,d=void 0===u?"":u,h=t.creator,f=void 0===h?"":h,g=t.keyword,v=void 0===g?"":g,b=t.label_ids,_=void 0===b?"":b;return{firstLoading:!0,listLoading:!1,projectInfoLoading:!0,searchStr:"",searchForm:D.map(function(t){var i=this;if(l()(this,e),this.$route.query[t.key])if(Array.isArray(t.value)){var a=this.$route.query[t.key].split(",");t.value="label_ids"===t.key?a.map(function(e){return l()(this,i),Number(e)}.bind(this)):a}else t.value=this.$route.query[t.key];return t}.bind(this)),isSearchFormOpen:D.some(function(t){return l()(this,e),this.$route.query[t.key]}.bind(this)),expiredSubflowTplList:[],isDeleteDialogShow:!1,isImportDialogShow:!1,isExportDialogShow:!1,isAuthorityDialogShow:!1,theDeleteTemplateId:void 0,theAuthorityManageId:void 0,active:!0,pending:{export:!1,delete:!1},editEndTime:void 0,isSubprocessUpdated:void 0,isHasSubprocess:void 0,deleteTemplateName:"",requestData:{category:r,creator:f,subprocessUpdateVal:""!==d?Number(d):"",queryTime:p?p.split(","):["",""],label_ids:_?_.split(","):[],flowName:v},totalPage:1,pagination:{current:Number(a),count:0,limit:Number(o),"limit-list":[15,30,50,100]},collectingId:"",collectListLoading:!1,collectionList:[],ordering:null,darkColorList:m.b,tableFields:P,defaultSelected:["id","name","label","edit_time","subprocess_has_update","creator_name"],setting:{fieldList:P,selectedFields:[],size:"small"},categoryTips:T}},computed:S(S({},Object(d.e)({site_url:function(e){return l()(this,void 0),e.site_url}.bind(void 0),templateList:function(e){return l()(this,void 0),e.templateList.templateListData}.bind(void 0),projectBaseInfo:function(e){return l()(this,void 0),e.template.projectBaseInfo}.bind(void 0),v1_import_flag:function(e){return l()(this,void 0),e.v1_import_flag}.bind(void 0),username:function(e){return l()(this,void 0),e.username}.bind(void 0)})),Object(d.e)("project",{timeZone:function(e){return l()(this,void 0),e.timezone}.bind(void 0),authActions:function(e){return l()(this,void 0),e.authActions}.bind(void 0),projectName:function(e){return l()(this,void 0),e.projectName}.bind(void 0)})),watch:{page:function(e,t){e!==t&&(this.pagination.current=Number(e)||1,this.getTemplateList())}},created:function(){var e=this;return n()(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.getFields(),e.getProjectBaseInfo(),e.getProjectLabelList(),e.getExpiredSubflowData(),e.getCollectList(),e.onSearchInput=h.a.debounce(e.searchInputhandler,500),t.next=8,e.getTemplateList();case 8:e.firstLoading=!1;case 9:case"end":return t.stop()}}),t)})))()},beforeRouteLeave:function(e,t,i){"templatePanel"===e.name&&e.query.template_id&&this.pushToVisitedFlow(e.query.template_id),i()},methods:S(S(S(S(S(S(S({},Object(d.b)(["loadCollectList","addToCollectList","deleteCollect"])),Object(d.b)("template/",["loadProjectBaseInfo"])),Object(d.b)("templateList/",["loadTemplateList","deleteTemplate","templateImport","templateExport","getExpiredSubProcess"])),Object(d.b)("project/",["getProjectLabelsWithDefault"])),Object(d.d)("template/",["setProjectBaseInfo"])),Object(d.d)("templateList/",["setTemplateListData"])),{},{getTemplateList:function(){var e=this;return n()(p.a.mark((function t(){var i,a,n,o,s,r,l,c,u,d,m,h,f;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,i=e.requestData,a=i.subprocessUpdateVal,n=i.creator,o=i.category,s=i.queryTime,r=i.flowName,l=i.label_ids,c=1===a||-1===a||0!==a&&void 0,u=1===a||-1!==a&&void 0,d={project__id:e.project_id,limit:e.pagination.limit,offset:(e.pagination.current-1)*e.pagination.limit,pipeline_template__name__icontains:r||void 0,pipeline_template__creator__contains:n||void 0,category:o||void 0,label_ids:l&&l.length?l.join(","):void 0,subprocess_has_update:u,has_subprocess:c,order_by:e.ordering||void 0},s[0]&&s[1]&&(d.pipeline_template__edit_time__gte=y.a.tz(s[0],e.timeZone).format("YYYY-MM-DD"),d.pipeline_template__edit_time__lte=y.a.tz(s[1],e.timeZone).add("1","d").format("YYYY-MM-DD")),t.next=9,e.loadTemplateList(d);case 9:m=t.sent,h=m.objects,e.setTemplateListData({list:h,isCommon:!1}),e.pagination.count=m.meta.total_count,f=Math.ceil(e.pagination.count/e.pagination.limit),e.totalPage=f||1,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),console.log(t.t0);case 20:return t.prev=20,e.listLoading=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[1,17,20,23]])})))()},getFields:function(){var e,t=this,i=localStorage.getItem("templateList");if(i){var a=JSON.parse(i),n=a.fieldList,o=a.size;this.setting.size=o,e=n}else e=this.defaultSelected;this.setting.selectedFields=this.tableFields.slice(0).filter(function(i){return l()(this,t),e.includes(i.id)}.bind(this))},getProjectBaseInfo:function(){var e=this;return n()(p.a.mark((function t(){var i,a,n=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.projectInfoLoading=!0,e.categoryLoading=!0,i=e.searchForm.find(function(e){return l()(this,n),"category"===e.key}.bind(this)),t.prev=3,t.next=6,e.loadProjectBaseInfo();case 6:a=t.sent,e.setProjectBaseInfo(a.data),i.list=a.data.task_categories,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.log(t.t0);case 14:return t.prev=14,e.projectInfoLoading=!1,i.loading=!1,t.finish(14);case 18:case"end":return t.stop()}}),t,this,[[3,11,14,18]])})))()},getExpiredSubflowData:function(){var e=this;return n()(p.a.mark((function t(){var i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getExpiredSubProcess({project__id:e.project_id});case 3:(i=t.sent).result&&(e.expiredSubflowTplList=i.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getCollectList:function(){var e=this;return n()(p.a.mark((function t(){var i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.collectListLoading=!0,t.next=4,e.loadCollectList();case 4:i=t.sent,e.collectionList=i.objects,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:return t.prev=11,e.collectListLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()},getProjectLabelList:function(){var e=this;return n()(p.a.mark((function t(){var i,a,n=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.searchForm.find(function(e){return l()(this,n),"label_ids"===e.key}.bind(this)),t.prev=1,e.templateLabelLoading=!0,t.next=5,e.getProjectLabelsWithDefault(e.project_id);case 5:a=t.sent,i.list=a.data.map(function(e){return l()(this,n),Object.assign({},e,{value:e.id})}.bind(this)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:return t.prev=12,e.templateLabelLoading=!1,i.loading=!1,t.finish(12);case 16:case"end":return t.stop()}}),t,this,[[1,9,12,16]])})))()},onShowMoreOperation:function(){window.reportInfo({page:"templateList",zone:"tableMoreOperation",event:"hover"})},checkCreatePermission:function(){if(this.hasPermission(["flow_create"],this.authActions))this.$router.push({name:"templatePanel",params:{type:"new",project_id:this.project_id}});else{var e={project:[{id:this.project_id,name:this.projectName}]};this.applyForPermission(["flow_create"],this.authActions,e)}},onSearchFormSubmit:function(e){this.requestData=Object.assign({},this.requestData,e),this.pagination.current=1,this.updateUrl(),this.getTemplateList()},searchInputhandler:function(e){this.requestData.flowName=e,this.pagination.current=1,this.getTemplateList()},onImportTemplate:function(){this.isImportDialogShow=!0},onImportConfirm:function(){this.isImportDialogShow=!1,this.getTemplateList()},onImportCancel:function(){this.isImportDialogShow=!1},onExportTemplate:function(){this.isExportDialogShow=!0},onExportConfirm:function(e){var t=this;return n()(p.a.mark((function i(){return p.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.pending.export){i.next=2;break}return i.abrupt("return");case 2:return t.pending.export=!0,i.prev=3,i.next=6,t.templateExport({list:e});case 6:i.sent.result&&(t.isExportDialogShow=!1),i.next=13;break;case 10:i.prev=10,i.t0=i.catch(3),console.log(i.t0);case 13:return i.prev=13,t.pending.export=!1,i.finish(13);case 16:case"end":return i.stop()}}),i,null,[[3,10,13,16]])})))()},onExportCancel:function(){this.isExportDialogShow=!1},onDeleteTemplate:function(e){this.hasPermission(["flow_delete"],e.auth_actions)?(this.theDeleteTemplateId=e.id,this.deleteTemplateName=e.name,this.isDeleteDialogShow=!0):this.onTemplatePermissonCheck(["flow_delete"],e)},handleSettingChange:function(e){var t=this,i=e.fields,a=e.size;this.setting.size=a,this.setting.selectedFields=i;var n=i.map(function(e){return l()(this,t),e.id}.bind(this));localStorage.setItem("templateList",JSON.stringify({fieldList:n,size:a}))},handleSortChange:function(e){var t=e.prop,i=e.order,a="pipeline_template__"+t;this.ordering="ascending"===i?a:"descending"===i?"-"+a:"",this.pagination.current=1,this.getTemplateList()},renderTableHeader:function(e,t){var i=t.column;t.$index;return"category_name"!==i.property?i.label:e("span",{class:"category-label"},[i.label,e("i",{class:"common-icon-info table-header-tips",directives:[{name:"bk-tooltips",value:this.categoryTips}]})])},onPageChange:function(e){this.pagination.current=e,this.updateUrl(),this.getTemplateList()},onPageLimitChange:function(e){this.pagination.limit=e,this.pagination.current=1,this.updateUrl(),this.getTemplateList()},updateUrl:function(){var e=this,t=this.pagination,i=t.current,a=t.limit,n=this.requestData,o=n.category,s=n.queryTime,r=n.subprocessUpdateVal,c=n.creator,p=n.label_ids,u=n.flowName,d={limit:a,category:o,subprocessUpdateVal:r,creator:c,page:i,queryTime:s.every(function(t){return l()(this,e),t}.bind(this))?s.join(","):"",label_ids:p.length?p.join(","):"",keyword:u},m={};Object.keys(d).forEach(function(t){l()(this,e);var i=d[t];(i||0===i||!1===i)&&(m[t]=i)}.bind(this)),this.$router.push({name:"process",params:{project_id:this.project_id},query:m})},onTemplatePermissonCheck:function(e,t){var i={id:this.project_id,name:this.projectName};this.applyForPermission(e,this.authActions,{flow:[t],project:[i]})},onDeleteConfirm:function(){var e=this;return n()(p.a.mark((function t(){var i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.pending.delete){t.next=2;break}return t.abrupt("return");case 2:return e.pending.delete=!0,t.prev=3,i={templateId:e.theDeleteTemplateId},t.next=7,e.deleteTemplate(i);case 7:e.theDeleteTemplateId=void 0,e.isDeleteDialogShow=!1,e.pagination.current>1&&e.totalPage===e.pagination.current&&e.pagination.count-(e.totalPage-1)*e.pagination.limit==1&&(e.pagination.current-=1),e.getTemplateList(),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.log(t.t0);case 16:return t.prev=16,e.pending.delete=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[3,13,16,19]])})))()},onDeleteCancel:function(){this.theDeleteTemplateId=void 0,this.isDeleteDialogShow=!1},getJumpUrl:function(e,t){var i={edit:{name:"templatePanel",params:{type:"edit"}},newTemplate:{name:"templatePanel",params:{type:"new"}},newTask:{name:"taskCreate",params:{project_id:this.project_id,step:"selectnode"}},clone:{name:"templatePanel",params:{type:"clone"}}}[e];return i.query={template_id:t},i},getExecuteHistoryUrl:function(e){return{name:"taskList",params:{project_id:this.project_id},query:{template_id:e,template_source:"project"}}},getSubflowContent:function(e){return e.has_subprocess?e.subprocess_has_update?u.a.t("待更新"):u.a.t("否"):"--"},handleSubflowFilter:function(){var e=this.$refs.advanceSearch;e.onAdvanceOpen(!0),e.onChangeFormItem(1,"subprocessUpdateVal"),e.submit()},onSearchLabel:function(e){var t=this.$refs.advanceSearch;t.onAdvanceOpen(!0),t.onChangeFormItem([e],"label_ids"),t.submit()},onCollectTemplate:function(e){var t=this;return n()(p.a.mark((function i(){var a,n=this;return p.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t.hasPermission(["flow_view"],e.auth_actions)){i.next=3;break}return t.onTemplatePermissonCheck(["flow_view"],e),i.abrupt("return");case 3:if("number"!=typeof t.collectingId){i.next=5;break}return i.abrupt("return");case 5:if(i.prev=5,t.collectingId=e.id,t.isCollected(e.id)){i.next=14;break}return i.next=10,t.addToCollectList([{extra_info:{project_id:e.project.id,template_id:e.template_id,template_source:e.template_source,name:e.name,id:e.id},category:"flow"}]);case 10:i.sent.objects.length&&t.$bkMessage({message:u.a.t("添加收藏成功！"),theme:"success"}),i.next=18;break;case 14:return a=t.collectionList.find(function(t){return l()(this,n),t.extra_info.id===e.id&&"flow"===t.category}.bind(this)).id,i.next=17,t.deleteCollect(a);case 17:t.$bkMessage({message:u.a.t("取消收藏成功！"),theme:"success"});case 18:t.getCollectList(),i.next=24;break;case 21:i.prev=21,i.t0=i.catch(5),console.log(i.t0);case 24:return i.prev=24,t.collectingId="",i.finish(24);case 27:case"end":return i.stop()}}),i,this,[[5,21,24,27]])})))()},isCollected:function(e){var t=this;return!!this.collectionList.find(function(i){return l()(this,t),i.extra_info.id===e&&"flow"===i.category}.bind(this))},pushToVisitedFlow:function(e){var t=this,i="".concat(this.username,"_").concat(this.project_id,"_").concat(e),a=sessionStorage.getItem("visitedFlow"),n=a?JSON.parse(a):[];n.some(function(e){return l()(this,t),e===i}.bind(this))||(n.push(i),sessionStorage.setItem("visitedFlow",JSON.stringify(n)))},isFlowVisited:function(e){var t=this,i="".concat(this.username,"_").concat(this.project_id,"_").concat(e),a=sessionStorage.getItem("visitedFlow");return!!a&&JSON.parse(a).some(function(e){return l()(this,t),e===i}.bind(this))}})},O=(i(1249),Object(C.a)(I,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"template-container"},[i("skeleton",{attrs:{loading:e.firstLoading,loader:"templateList"}},[i("div",{staticClass:"list-wrapper"},[i("list-page-tips-title",{attrs:{num:e.expiredSubflowTplList.length},on:{viewClick:e.handleSubflowFilter}}),e._v(" "),i("advance-search-form",{ref:"advanceSearch",attrs:{id:"templateList",open:e.isSearchFormOpen,"search-form":e.searchForm,"search-config":{placeholder:e.$t("请输入流程名称")}},on:{onSearchInput:e.onSearchInput,submit:e.onSearchFormSubmit},scopedSlots:e._u([{key:"operation",fn:function(){return[i("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["flow_create"],e.authActions)},expression:"{ active: !hasPermission(['flow_create'], authActions) }"}],class:["create-template-btn",{"btn-permission-disable":!e.hasPermission(["flow_create"],e.authActions)}],attrs:{theme:"primary"},on:{click:e.checkCreatePermission}},[e._v("\n                        "+e._s(e.$t("新建"))+"\n                    ")]),e._v(" "),i("bk-button",{staticClass:"template-btn",attrs:{theme:"default"},on:{click:e.onExportTemplate}},[e._v("\n                        "+e._s(e.$t("导出"))+"\n                    ")]),e._v(" "),i("bk-button",{staticClass:"template-btn",attrs:{theme:"default"},on:{click:e.onImportTemplate}},[e._v("\n                        "+e._s(e.$t("导入"))+"\n                    ")])]},proxy:!0}])}),e._v(" "),i("div",{staticClass:"template-table-content"},[i("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:!e.firstLoading&&e.listLoading,opacity:1,zIndex:100},expression:"{ isLoading: !firstLoading && listLoading, opacity: 1, zIndex: 100 }"}],staticClass:"template-table",attrs:{data:e.templateList,pagination:e.pagination,size:e.setting.size},on:{"sort-change":e.handleSortChange,"page-change":e.onPageChange,"page-limit-change":e.onPageLimitChange}},[e._l(e.setting.selectedFields,(function(t){return i("bk-table-column",{key:t.id,attrs:{label:t.label,prop:t.id,width:t.width,"min-width":t.min_width,"render-header":e.renderTableHeader,sortable:t.sortable},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return["name"===t.id?i("div",[[e.hasPermission(["flow_view"],n.auth_actions)?i("router-link",{staticClass:"template-name",attrs:{title:n.name,to:e.getJumpUrl("edit",n.id)}},[e._v("\n                                        "+e._s(n.name)+"\n                                    ")]):i("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",on:{click:function(t){return e.onTemplatePermissonCheck(["flow_view"],n)}}},[e._v("\n                                        "+e._s(n.name)+"\n                                    ")])]],2):"label"===t.id?i("div",{staticClass:"label-column"},[n.template_labels&&n.template_labels.length>0?e._l(n.template_labels,(function(t){return i("span",{key:t.id,staticClass:"label-name",style:{background:t.color,color:e.darkColorList.includes(t.color)?"#fff":"#262e4f"},on:{click:function(i){return e.onSearchLabel(t.label_id)}}},[e._v("\n                                        "+e._s(t.name)+"\n                                    ")])})):i("span",[e._v("--")])],2):"subprocess_has_update"===t.id?i("div",{class:["subflow-update",{"subflow-has-update":n.subprocess_has_update}]},[e._v("\n                                "+e._s(e.getSubflowContent(n))+"\n                                "),e.isFlowVisited(n.id)?e._e():i("span",{staticClass:"red-dot"})]):[i("span",{attrs:{title:n[t.id]}},[e._v(e._s(n[t.id]||"--"))])]]}}],null,!0)})})),e._v(" "),i("bk-table-column",{staticClass:"operation-cell",attrs:{label:e.$t("操作"),width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"template-operation"},[[e.hasPermission(["flow_create_task"],t.row.auth_actions)?i("router-link",{staticClass:"template-operate-btn",attrs:{to:e.getJumpUrl("newTask",t.row.id)}},[e._v("\n                                        "+e._s(e.$t("新建任务"))+"\n                                    ")]):i("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",on:{click:function(i){return e.onTemplatePermissonCheck(["flow_create_task"],t.row)}}},[e._v("\n                                        "+e._s(e.$t("新建任务"))+"\n                                    ")]),e._v(" "),e.hasPermission(["flow_view"],t.row.auth_actions)?i("router-link",{staticClass:"template-operate-btn",attrs:{to:e.getJumpUrl("clone",t.row.id)}},[e._v("\n                                        "+e._s(e.$t("克隆"))+"\n                                    ")]):i("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",on:{click:function(i){return e.onTemplatePermissonCheck(["flow_view"],t.row)}}},[e._v("\n                                        "+e._s(e.$t("克隆"))+"\n                                    ")]),e._v(" "),i("router-link",{staticClass:"template-operate-btn",attrs:{to:e.getExecuteHistoryUrl(t.row.id)}},[e._v("\n                                        "+e._s(e.$t("执行历史"))+"\n                                    ")]),e._v(" "),i("bk-popover",{attrs:{theme:"light",placement:"bottom-start","ext-cls":"common-dropdown-btn-popver","z-index":2e3,distance:0,arrow:!1,"tippy-options":{boundary:"window",duration:[0,0]},"on-show":e.onShowMoreOperation}},[i("i",{staticClass:"bk-icon icon-more drop-icon-ellipsis"}),e._v(" "),i("ul",{attrs:{slot:"content"},slot:"content"},[i("li",{staticClass:"opt-btn"},[i("a",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["flow_view"],t.row.auth_actions)},expression:"{ active: !hasPermission(['flow_view'], props.row.auth_actions) }"}],class:{disable:e.collectingId===t.row.id||e.collectListLoading,"text-permission-disable":!e.hasPermission(["flow_view"],t.row.auth_actions)},attrs:{href:"javascript:void(0);"},on:{click:function(i){return e.onCollectTemplate(t.row,i)}}},[e._v("\n                                                    "+e._s(e.isCollected(t.row.id)?e.$t("取消收藏"):e.$t("收藏"))+"\n                                                ")])]),e._v(" "),i("li",{staticClass:"opt-btn"},[e.hasPermission(["flow_edit"],t.row.auth_actions)?i("router-link",{attrs:{tag:"a",to:e.getJumpUrl("edit",t.row.id)}},[e._v("\n                                                    "+e._s(e.$t("编辑"))+"\n                                                ")]):i("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",on:{click:function(i){return e.onTemplatePermissonCheck(["flow_edit"],t.row)}}},[e._v("\n                                                    "+e._s(e.$t("编辑"))+"\n                                                ")])],1),e._v(" "),i("li",{staticClass:"opt-btn"},[i("a",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["flow_delete"],t.row.auth_actions)},expression:"{ active: !hasPermission(['flow_delete'], props.row.auth_actions) }"}],class:{"text-permission-disable":!e.hasPermission(["flow_delete"],t.row.auth_actions)},attrs:{href:"javascript:void(0);"},on:{click:function(i){return e.onDeleteTemplate(t.row,i)}}},[e._v("\n                                                    "+e._s(e.$t("删除"))+"\n                                                ")])])])])]],2)]}}])}),e._v(" "),i("bk-table-column",{attrs:{type:"setting"}},[i("bk-table-setting-content",{attrs:{fields:e.setting.fieldList,selected:e.setting.selectedFields,size:e.setting.size},on:{"setting-change":e.handleSettingChange}})],1),e._v(" "),i("div",{staticClass:"empty-data",attrs:{slot:"empty"},slot:"empty"},[i("NoData",{attrs:{message:e.$t("无数据")}})],1)],2)],1)],1)]),e._v(" "),i("ImportTemplateDialog",{attrs:{"auth-actions":e.authActions,"is-import-dialog-show":e.isImportDialogShow},on:{onImportConfirm:e.onImportConfirm,onImportCancel:e.onImportCancel}}),e._v(" "),i("ExportTemplateDialog",{attrs:{"is-export-dialog-show":e.isExportDialogShow,"project-info-loading":e.projectInfoLoading,pending:e.pending.export,project_id:e.project_id},on:{onExportConfirm:e.onExportConfirm,onExportCancel:e.onExportCancel}}),e._v(" "),i("bk-dialog",{attrs:{width:"400","mask-close":!1,"header-position":"left","ext-cls":"common-dialog",title:e.$t("删除"),value:e.isDeleteDialogShow,"auto-close":!1},on:{confirm:e.onDeleteConfirm,cancel:e.onDeleteCancel}},[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.pending.delete,opacity:1,zIndex:100},expression:"{ isLoading: pending.delete, opacity: 1, zIndex: 100 }"}],staticClass:"dialog-content"},[e._v("\n            "+e._s(e.$t("确认删除")+'"'+e.deleteTemplateName+'"?')+"\n        ")])])],1)}),[],!1,null,"0a6a6582",null));t.default=O.exports},792:function(e,t,i){},910:function(e,t,i){"use strict";i(792)},996:function(e,t,i){"use strict";var a={name:"NotifyInfo",props:{content:{type:String},show:{type:Boolean,default:!0},theme:{type:String,default:"danger"}},data:function(){return{visible:this.show}},watch:{show:function(e){this.visible=e}},methods:{onHide:function(){this.$emit("update:show",!1)}}},n=(i(910),i(9)),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",[e.show?i("div",{class:["notify-info",e.theme]},[i("i",{staticClass:"bk-icon icon-exclamation-circle tips-icon"}),e._v(" "),i("div",{staticClass:"content-area"},[e._t("default",(function(){return[i("div",{staticClass:"content",attrs:{title:e.content}},[e._v(e._s(e.content))])]}))],2),e._v(" "),i("div",{staticClass:"button-area"},[e._t("buttons",(function(){return[i("bk-button",{attrs:{text:!0,size:"small"},on:{click:e.onHide}},[e._v("\n                    "+e._s(e.$t("收起"))+"\n                ")])]}))],2)]):e._e()])}),[],!1,null,"331d8e12",null);t.a=o.exports}}]);