(window.webpackJsonp=window.webpackJsonp||[]).push([[16,17],{567:function(e,t,i){"use strict";i.r(t);i(38),i(49),i(50);var a=i(16),n=i.n(a),r=i(5),o=i.n(r),s=i(0),c=i.n(s),l=i(4),d=i.n(l),u=(i(67),i(127),i(27),i(81),i(183),i(37),i(68),i(103),i(23),i(43),i(22),i(26),i(80),i(314),i(1)),p=i(7),h=i(28),m=i(102),f=i(675),g=i(611),v=i(858),b=(i(101),i(39),i(104),i(128),i(185),i(6)),k=i(860),y=i(731),w={name:"LoadingBtnDialog",props:{dialogFooterData:{type:Array,default:function(){return[{type:"primary",btnText:u.a.t("确认"),click:"onConfirm"},{btnText:u.a.t("取消"),click:"onCancel"}]}}},methods:{onClick:function(e){this.$emit(e)}}},C=(i(979),i(9)),P=Object(C.a)(w,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"common-dialog-footer-btn-wrapper"},e._l(e.dialogFooterData,(function(t,a){return i("bk-button",{key:a,staticClass:"dialog-btn",attrs:{theme:t.type,icon:t.icon,loading:t.loading,disabled:t.disabled},on:{click:function(i){return e.onClick(t.click)}}},[e._v("\n        "+e._s(t.btnText)+"\n    ")])})),1)}),[],!1,null,null,null).exports;function x(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function A(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?x(Object(i),!0).forEach((function(t){o()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var T={name:"ModifyPeriodicDialog",components:{TaskParamEdit:y.a,NoData:g.a,LoopRuleSelect:k.a,DialogLoadingBtn:P},props:["isModifyDialogShow","taskId","cron","constants","loading"],data:function(){return{periodicRule:{required:!0,regex:b.h},periodicCronImg:i(728)("./"+u.a.t("task-zh")+".png"),dialogFooterData:[{type:"primary",loading:!1,btnText:u.a.t("确认"),click:"onConfirm"},{btnText:u.a.t("取消"),click:"onCancel"}]}},computed:{isVariableEmpty:function(){return 0===Object.keys(this.constants).length}},methods:A(A({},Object(p.b)("periodic/",["modifyPeriodicCron","modifyPeriodicConstants"])),{},{onModifyPeriodicCancel:function(){this.$emit("onModifyPeriodicCancel")},onModifyPeriodicConfirm:function(){var e=this,t=this.$refs.loopRuleSelect.validationExpression();if(t.check){this.dialogFooterData[0].loading=!0;var i=this.$refs.TaskParamEdit;this.$validator.validateAll().then(function(){var a=n()(d.a.mark((function a(n){var r,o,s,c,l,p,h,m,f;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=!0,o="",!i){a.next=8;break}return a.next=5,i.getVariableData();case 5:s=a.sent,o=s,r=i.validate();case 8:if(5===(c=t.rule.split(" ")).length){a.next=12;break}return e.$bkMessage({message:u.a.t("输入周期表达式非法，请校验"),theme:"error"}),a.abrupt("return");case 12:if(n&&r){a.next=15;break}return e.dialogFooterData[0].loading=!1,a.abrupt("return");case 15:if(l={minute:c[0],hour:c[1],day_of_week:c[2],day_of_month:c[3],month_of_year:c[4]},p={taskId:e.taskId,cron:l},e.cron===t.rule&&""===o)e.dialogFooterData[0].loading=!1,e.$emit("onModifyPeriodicCancel");else if(""===o)e.modifyCron(p);else{for(m in h={},o)h[m]=o[m].value;f={taskId:e.taskId,constants:h},e.modifyPeriodic(p,f)}case 18:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}},modifyPeriodic:function(e,t){var i=this;try{Promise.all([this.modifyPeriodicConstants(t),this.modifyPeriodicCron(e)]).then(function(e){c()(this,i),e[0].result&&e[1].result?this.$bkMessage({message:u.a.t("修改周期任务信息成功"),theme:"success"}):e[0].result?this.$bkMessage({message:u.a.t("修改周期任务参数成功，但表达式修改未成功，请重试"),theme:"warning"}):e[1].result?this.$bkMessage({message:u.a.t("修改周期任务表达式成功，但任务参数未修改成功，请重试"),theme:"warning"}):this.$bkMessage({message:u.a.t("修改周期任务失败，请联系管理员"),theme:"error"}),this.dialogFooterData[0].loading=!1,this.$emit("onModifyPeriodicConfirm")}.bind(this))}catch(e){console.log(e)}},modifyCron:function(e){var t=this;return n()(d.a.mark((function i(){return d.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.modifyPeriodicCron(e);case 2:i.sent.result?t.$bkMessage({message:u.a.t("修改周期任务表达式成功"),theme:"success"}):t.$bkMessage({message:u.a.t("修改周期任务失败，请联系管理员"),theme:"error"}),t.dialogFooterData[0].loading=!1,t.$emit("onModifyPeriodicConfirm");case 6:case"end":return i.stop()}}),i)})))()}})},L=(i(980),Object(C.a)(T,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("bk-dialog",{attrs:{width:"600","ext-cls":"common-dialog",theme:"primary","mask-close":!1,"header-position":"left",title:e.$t("修改周期任务"),value:e.isModifyDialogShow},on:{confirm:e.onModifyPeriodicConfirm,cancel:e.onModifyPeriodicCancel}},[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading,opacity:1,zIndex:100},expression:"{ isLoading: loading, opacity: 1, zIndex: 100 }"}]},[i("div",{staticClass:"periodic-info"},[i("h3",{staticClass:"local-section-title"},[e._v(e._s(e.$t("周期信息")))]),e._v(" "),i("div",{staticClass:"common-form-item"},[i("LoopRuleSelect",{ref:"loopRuleSelect",staticClass:"loop-rule",attrs:{"manual-input-value":e.cron}})],1),e._v(" "),e.loading?e._e():i("div",{staticClass:"param-info"},[i("h3",{staticClass:"local-section-title"},[e._v(e._s(e.$t("参数信息")))]),e._v(" "),i("div",{staticClass:"common-form-content"},[e.isVariableEmpty?i("NoData"):i("TaskParamEdit",{ref:"TaskParamEdit",staticClass:"task-param-edit",attrs:{constants:e.constants}})],1)])])]),e._v(" "),i("DialogLoadingBtn",{attrs:{slot:"footer","dialog-footer-data":e.dialogFooterData},on:{onConfirm:e.onModifyPeriodicConfirm,onCancel:e.onModifyPeriodicCancel},slot:"footer"})],1)}),[],!1,null,"0599ccf5",null).exports),O=i(51),D=i.n(O);i(70);function j(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function E(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?j(Object(i),!0).forEach((function(t){o()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var _={name:"BootRecordDialog",components:{NoData:g.a},props:{show:{type:Boolean,default:!1},id:{type:Number,default:null}},data:function(){return{isLoading:!1,isThrottled:!1,isPageOver:!1,pageSize:15,totalPage:null,currentPage:0,pollingTimer:null,loading:!0,isShow:this.show,recordData:[]}},watch:{show:function(e){e&&(this.isShow=e,this.currentPage=0,this.offset=0,this.recordData=[],this.getRecord())}},mounted:function(){this.tableScroller=this.$el.querySelector(".bk-table-body-wrapper"),this.tableScroller.addEventListener("scroll",this.handleTableScroll,{passive:!0})},beforeDestroy:function(){this.tableScroller.removeEventListener("scroll",this.handleTableScroll)},methods:E(E({},Object(p.b)("admin/",["periodTaskHistory"])),{},{handleTableScroll:function(){var e=this;this.isPageOver||this.isThrottled||(this.isThrottled=!0,this.pollingTimer=setTimeout(function(){c()(this,e),this.isThrottled=!1;var t=this.tableScroller;t.scrollHeight-t.offsetHeight-t.scrollTop<10&&(this.currentPage+=1,this.isPageOver=this.currentPage===this.totalPage,clearTimeout(this.pollingTimer),this.isLoading=!0,this.getRecord())}.bind(this),200))},getRecord:function(){var e=this;return n()(d.a.mark((function t(){var i,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.currentPage||(e.loading=!0),t.next=4,e.periodTaskHistory({task_id:e.id,limit:e.pageSize,offset:e.currentPage*e.pageSize});case 4:a=t.sent,e.totalPage=Math.floor(a.meta.total_count/e.pageSize),(i=e.recordData).push.apply(i,D()(a.objects)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:return t.prev=12,e.isLoading=!1,e.loading=!1,t.finish(12);case 16:case"end":return t.stop()}}),t,null,[[0,9,12,16]])})))()},transformFailInfo:function(e){return e?"string"==typeof e?e.replace(/\n/g,"<br>"):e:""},onCloseDialog:function(){this.$emit("onClose")}})},S=(i(981),Object(C.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("bk-dialog",{attrs:{width:"600","ext-cls":"common-dialog",theme:"primary","mask-close":!1,"header-position":"left",title:e.$t("启动记录"),value:e.show},on:{cancel:e.onCloseDialog}},[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading,opacity:1,zIndex:100},expression:"{ isLoading: loading, opacity: 1, zIndex: 100 }"}],staticClass:"dialog-content"},[i("bk-table",{ref:"recordTable",attrs:{data:e.recordData,"max-height":350}},[i("bk-table-column",{attrs:{type:"expand",width:"30",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.ex_data?i("div",{domProps:{innerHTML:e._s(e.transformFailInfo(t.row.ex_data))}}):i("div",{staticClass:"no-error"},[e._v(e._s(e.$t("无异常信息")))])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("序号"),prop:"id"}}),e._v(" "),i("bk-table-column",{attrs:{width:200,label:e.$t("启动时间"),prop:"start_at"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("是否启动成功")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.start_success?e.$t("是"):e.$t("否"))+"\n                ")]}}])}),e._v(" "),i("bk-table-column",{attrs:{width:80,label:e.$t("异常信息")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.start_success?i("span",[e._v("--")]):i("span",{staticClass:"view-btn",on:{click:function(i){return e.$refs.recordTable.toggleRowExpansion(t.row)}}},[e._v("\n                        "+e._s(e.$t("查看"))+"\n                    ")])]}}])}),e._v(" "),i("div",{staticClass:"no-data-matched",attrs:{slot:"empty"},slot:"empty"},[i("NoData")],1),e._v(" "),e.isLoading?i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading,zIndex:100},expression:"{ isLoading: isLoading, zIndex: 100 }"}],staticClass:"is-loading",attrs:{slot:"append"},slot:"append"}):e._e()],1)],1),e._v(" "),i("div",{staticClass:"footer-wrapper",attrs:{slot:"footer"},slot:"footer"},[i("bk-button",{on:{click:e.onCloseDialog}},[e._v(e._s(e.$t("关闭")))])],1)])}),[],!1,null,"19f17ee8",null).exports),B={name:"DeletePeriodicDialog",props:["isDeleteDialogShow","templateName","deleting"],computed:{deleteInfo:function(){return u.a.t("确认删除")+'"'+this.templateName+'"'+u.a.t("？")}},methods:{onDeletePeriodicCancel:function(){this.$emit("onDeletePeriodicCancel")},onDeletePeriodicConfrim:function(){this.$emit("onDeletePeriodicConfirm")}}},R=(i(982),Object(C.a)(B,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("bk-dialog",{attrs:{width:"400","ext-cls":"common-dialog",theme:"primary","mask-close":!1,"header-position":"left",title:e.$t("确认删除"),value:e.isDeleteDialogShow,draggable:!0},on:{confirm:e.onDeletePeriodicConfrim,cancel:e.onDeletePeriodicCancel}},[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.deleting,opacity:1,zIndex:100},expression:"{ isLoading: deleting, opacity: 1, zIndex: 100 }"}],staticClass:"dialog-content"},[i("div",{staticClass:"information-tips"},[e._v(e._s(e.deleteInfo))])])])}),[],!1,null,"842dd4e8",null).exports),N=i(695);function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function F(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(Object(i),!0).forEach((function(t){o()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var M=[{type:"input",key:"creator",label:u.a.t("创建人"),placeholder:u.a.t("请输入创建人"),value:""},{type:"select",label:u.a.t("状态"),key:"enabled",loading:!1,placeholder:u.a.t("请选择状态"),list:[{value:"true",name:u.a.t("启动")},{value:"false",name:u.a.t("暂停")}],value:""}],U=[{id:"id",label:u.a.t("ID"),width:80},{id:"name",label:u.a.t("任务名称"),disabled:!0,min_width:200},{id:"process_template",label:u.a.t("流程模板"),min_width:200},{id:"project",label:u.a.t("项目"),isShow:!0,width:140},{id:"cron",label:u.a.t("周期规则"),width:150},{id:"last_run_at",label:u.a.t("上次运行时间"),width:200},{id:"creator",label:u.a.t("创建人"),width:120},{id:"total_run_count",label:u.a.t("运行次数"),width:100},{id:"periodic_status",label:u.a.t("状态"),width:100}],z={name:"PeriodicList",components:{Skeleton:f.a,AdvanceSearchForm:N.a,NoData:g.a,TaskCreateDialog:v.a,ModifyPeriodicDialog:L,BootRecordDialog:S,DeletePeriodicDialog:R},mixins:[m.a],props:{project_id:{type:[String,Number]},admin:{type:Boolean,default:!1}},data:function(){var e=this,t=this.$route.query,i=t.page,a=void 0===i?1:i,n=t.limit,r=void 0===n?15:n,o=t.creator,s=void 0===o?"":o,l=t.enabled,d=void 0===l?"":l,u=t.keyword,p=void 0===u?"":u;return{firstLoading:!0,businessInfoLoading:!0,isNewTaskDialogShow:!1,listLoading:!1,deleting:!1,totalPage:1,isDeleteDialogShow:!1,isModifyDialogShow:!1,isBootRecordDialogShow:!1,selectedPeriodicId:void 0,periodicList:[],collectingId:"",collectListLoading:!1,collectionList:[],selectedCron:void 0,constants:{},modifyDialogLoading:!1,selectedTemplateName:void 0,periodEntrance:"",taskCategory:[],searchForm:M.map(function(t){return c()(this,e),this.$route.query[t.key]&&(Array.isArray(t.value)?t.value=this.$route.query[t.key].split(","):t.value=this.$route.query[t.key]),t}.bind(this)),isSearchFormOpen:M.some(function(t){return c()(this,e),this.$route.query[t.key]}.bind(this)),requestData:{creator:s,enabled:d,taskName:p},pagination:{current:Number(a),count:0,limit:Number(r),"limit-list":[15,30,50,100]},tableFields:U,setting:{fieldList:U,selectedFields:U.slice(0),size:"small"}}},computed:F(F({},Object(p.e)({hasAdminPerm:function(e){return c()(this,void 0),e.hasAdminPerm}.bind(void 0)})),{},{adminView:function(){return this.hasAdminPerm&&this.admin}}),created:function(){var e=this;return n()(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.getFields(),e.getBizBaseInfo(),e.getCollectList(),e.onSearchInput=h.a.debounce(e.searchInputhandler,500),t.next=6,e.getPeriodicList();case 6:e.firstLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},methods:F(F(F(F({},Object(p.b)(["addToCollectList","deleteCollect","loadCollectList"])),Object(p.b)("periodic/",["loadPeriodicList","setPeriodicEnable","getPeriodic","deletePeriodic"])),Object(p.b)("template/",["loadProjectBaseInfo"])),{},{getPeriodicList:function(){var e=this;return n()(d.a.mark((function t(){var i,a,n,r,o,s,c,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,i=e.requestData,a=i.creator,n=i.enabled,r=i.taskName,o={limit:e.pagination.limit,offset:(e.pagination.current-1)*e.pagination.limit,task__celery_task__enabled:n||void 0,task__creator__contains:a||void 0,task__name__icontains:r||void 0},e.admin||(o.project__id=e.project_id),t.next=7,e.loadPeriodicList(o);case 7:s=t.sent,c=s.objects,e.periodicList=c,e.pagination.count=s.meta.total_count,l=Math.ceil(e.pagination.count/e.pagination.limit),e.totalPage=l||1,t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.log(t.t0);case 18:return t.prev=18,e.listLoading=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[1,15,18,21]])})))()},getBizBaseInfo:function(){var e=this;return n()(d.a.mark((function t(){var i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.loadProjectBaseInfo();case 3:i=t.sent,e.taskCategory=i.data.task_categories,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getFields:function(){var e=this,t=localStorage.getItem("PeriodicList");if(t){var i=JSON.parse(t),a=i.fieldList,n=i.size;this.setting.size=n,this.setting.selectedFields=this.tableFields.slice(0).filter(function(t){return c()(this,e),a.includes(t.id)}.bind(this))}},getCollectList:function(){var e=this;return n()(d.a.mark((function t(){var i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.collectListLoading=!0,t.next=4,e.loadCollectList();case 4:i=t.sent,e.collectionList=i.objects,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:return t.prev=11,e.collectListLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()},searchInputhandler:function(e){this.requestData.taskName=e,this.pagination.current=1,this.getPeriodicList()},onPeriodicPermissonCheck:function(e,t){var i=t.id,a=t.name,n=t.task_template_name,r=t.template_id,o=t.project,s={periodic_task:[{id:i,name:a}],flow:[{id:r,name:n}],project:[{id:o.id,name:o.name}]};this.applyForPermission(e,t.auth_actions,s)},onDeletePeriodic:function(e){this.hasPermission(["periodic_task_delete"],e.auth_actions)?(this.isDeleteDialogShow=!0,this.selectedDeleteTaskId=e.id,this.selectedTemplateName=e.name):this.onPeriodicPermissonCheck(["periodic_task_delete"],e)},handleSettingChange:function(e){var t=this,i=e.fields,a=e.size;this.setting.size=a,this.setting.selectedFields=i;var n=i.map(function(e){return c()(this,t),e.id}.bind(this));localStorage.setItem("PeriodicList",JSON.stringify({fieldList:n,size:a}))},onPageChange:function(e){this.pagination.current=e,this.updateUrl(),this.getPeriodicList()},handlePageLimitChange:function(e){this.pagination.limit=e,this.pagination.current=1,this.updateUrl(),this.getPeriodicList()},onSearchFormSubmit:function(e){this.requestData=Object.assign({},this.requestData,e),this.pagination.current=1,this.updateUrl(),this.getPeriodicList()},updateUrl:function(){var e=this,t=this.pagination,i=t.current,a=t.limit,n=this.requestData,r={limit:a,creator:n.creator,enabled:n.enabled,page:i,keyword:n.taskName},o={};Object.keys(r).forEach(function(t){c()(this,e);var i=r[t];(i||0===i||!1===i)&&(o[t]=i)}.bind(this)),this.admin?this.$router.push({name:"adminPeriodic",query:o}):this.$router.push({name:"periodicTemplate",params:{project_id:this.project_id},query:o})},onSetEnable:function(e){var t=this;return n()(d.a.mark((function i(){var a,n,r=this;return d.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t.hasPermission(["periodic_task_edit"],e.auth_actions)){i.next=3;break}return t.onPeriodicPermissonCheck(["periodic_task_edit"],e),i.abrupt("return");case 3:return i.prev=3,a={taskId:e.id,enabled:!e.enabled},i.next=7,t.setPeriodicEnable(a);case 7:i.sent.result&&((n=t.periodicList.find(function(t){return c()(this,r),t.id===e.id}.bind(this))).enabled=!n.enabled),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(3),console.log(i.t0);case 14:case"end":return i.stop()}}),i,this,[[3,11]])})))()},onModifyCronPeriodic:function(e){var t=e.enabled,i=e.id,a=e.cron;if(this.hasPermission(["periodic_task_edit"],e.auth_actions)){if(!t){var n=this.splitPeriodicCron(a);this.selectedCron=n,this.selectedPeriodicId=i,this.getPeriodicConstant(i),this.isModifyDialogShow=!0}}else this.onPeriodicPermissonCheck(["periodic_task_edit"],e)},onModifyPeriodicCancel:function(){this.isModifyDialogShow=!1},onModifyPeriodicConfirm:function(){this.isModifyDialogShow=!1,this.getPeriodicList()},getPeriodicConstant:function(e){var t=this;return n()(d.a.mark((function i(){var a,n;return d.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.modifyDialogLoading=!0,a={taskId:e},i.next=4,t.getPeriodic(a);case 4:n=i.sent,t.constants=n.form,t.modifyDialogLoading=!1;case 7:case"end":return i.stop()}}),i)})))()},onDeletePeriodicConfirm:function(){this.deleteSelecedPeriodic()},deleteSelecedPeriodic:function(){var e=this;return n()(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.deleting){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.deleting=!0,t.next=6,e.deletePeriodic(e.selectedDeleteTaskId);case 6:e.$bkMessage({message:u.a.t("删除周期任务成功"),theme:"success"}),e.isDeleteDialogShow=!1,e.pagination.current>1&&e.totalPage===e.pagination.current&&e.pagination.count-(e.totalPage-1)*e.pagination.limit==1&&(e.pagination.current-=1),e.getPeriodicList(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0);case 15:return t.prev=15,e.deleting=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))()},onDeletePeriodicCancel:function(){this.isDeleteDialogShow=!1},splitPeriodicCron:function(e){return e.split("(")[0].trim()},onCreatePeriodTask:function(){this.isNewTaskDialogShow=!0},onCreateTaskCancel:function(){this.isNewTaskDialogShow=!1},onRecordView:function(e){this.selectedPeriodicId=e.id,this.isBootRecordDialogShow=!0},templateNameUrl:function(e){var t=e.template_id,i=e.template_source;return{name:"templatePanel",params:{type:"edit",project_id:e.project.id},query:{template_id:t,common:"common"===i||void 0}}},onCollectTask:function(e,t){var i=this;return n()(d.a.mark((function a(){var n,r=this;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i.hasPermission(["periodic_task_view"],e.auth_actions)){a.next=3;break}return i.onPeriodicPermissonCheck(["periodic_task_view"],e,t),a.abrupt("return");case 3:if("number"!=typeof i.collectingId){a.next=5;break}return a.abrupt("return");case 5:if(a.prev=5,i.collectingId=e.id,i.isCollected(e.id)){a.next=14;break}return a.next=10,i.addToCollectList([{extra_info:{project_id:e.project.id,template_id:e.template_id,name:e.name,id:e.id},category:"periodic_task"}]);case 10:a.sent.objects.length&&i.$bkMessage({message:u.a.t("添加收藏成功！"),theme:"success"}),a.next=18;break;case 14:return n=i.collectionList.find(function(t){return c()(this,r),t.extra_info.id===e.id&&"periodic_task"===t.category}.bind(this)).id,a.next=17,i.deleteCollect(n);case 17:i.$bkMessage({message:u.a.t("取消收藏成功！"),theme:"success"});case 18:i.getCollectList(),a.next=24;break;case 21:a.prev=21,a.t0=a.catch(5),console.log(a.t0);case 24:return a.prev=24,i.collectingId="",a.finish(24);case 27:case"end":return a.stop()}}),a,this,[[5,21,24,27]])})))()},isCollected:function(e){var t=this;return!!this.collectionList.find(function(i){return c()(this,t),i.extra_info.id===e&&"periodic_task"===i.category}.bind(this))}})},W=(i(983),Object(C.a)(z,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"periodic-container"},[i("skeleton",{attrs:{loading:e.firstLoading,loader:"taskList"}},[i("div",{staticClass:"list-wrapper"},[i("advance-search-form",{attrs:{id:"periodicList",open:e.isSearchFormOpen,"search-config":{placeholder:e.$t("请输入任务名称"),value:e.requestData.taskName},"search-form":e.searchForm},on:{onSearchInput:e.onSearchInput,submit:e.onSearchFormSubmit},scopedSlots:e._u([e.adminView?null:{key:"operation",fn:function(){return[i("bk-button",{ref:"childComponent",staticStyle:{"min-width":"120px"},attrs:{theme:"primary",size:"normal"},on:{click:e.onCreatePeriodTask}},[e._v("\n                        "+e._s(e.$t("新建"))+"\n                    ")])]},proxy:!0}],null,!0)}),e._v(" "),i("div",{staticClass:"periodic-table-content"},[i("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:!e.firstLoading&&e.listLoading,opacity:1,zIndex:100},expression:"{ isLoading: !firstLoading && listLoading, opacity: 1, zIndex: 100 }"}],attrs:{data:e.periodicList,pagination:e.pagination,size:e.setting.size},on:{"page-change":e.onPageChange,"page-limit-change":e.handlePageLimitChange}},[e._l(e.setting.selectedFields,(function(t){return[!t.isShow||e.adminView?i("bk-table-column",{key:t.id,attrs:{label:t.label,prop:t.id,width:t.width,"min-width":t.min_width},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return["process_template"===t.id?i("div",[e.hasPermission(["periodic_task_view"],n.auth_actions)?i("router-link",{staticClass:"periodic-name",attrs:{title:n.task_template_name,to:e.templateNameUrl(n)}},[e._v("\n                                        "+e._s(n.task_template_name)+"\n                                    ")]):i("a",{directives:[{name:"cursor",rawName:"v-cursor"}],staticClass:"text-permission-disable",on:{click:function(t){return e.onPeriodicPermissonCheck(["periodic_task_view"],n,t)}}},[e._v("\n                                        "+e._s(n.task_template_name)+"\n                                    ")])],1):"project"===t.id?i("div",[i("span",{attrs:{title:n.project.name}},[e._v(e._s(n.project.name))])]):"cron"===t.id?i("div",[i("div",{attrs:{title:e.splitPeriodicCron(n.cron)}},[e._v(e._s(e.splitPeriodicCron(n.cron)))])]):"periodic_status"===t.id?i("div",{staticClass:"periodic-status"},[i("span",{class:n.enabled?"bk-icon icon-check-circle-shape":"common-icon-dark-circle-pause"}),e._v("\n                                    "+e._s(n.enabled?e.$t("启动"):e.$t("暂停"))+"\n                                ")]):[i("span",{attrs:{title:n[t.id]||"--"}},[e._v(e._s(n[t.id]||"--"))])]]}}],null,!0)}):e._e()]})),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("操作"),width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"periodic-operation"},[e.adminView?i("a",{attrs:{href:"javascript:void(0);"},on:{click:function(i){return e.onRecordView(t.row,i)}}},[e._v("\n                                    "+e._s(e.$t("启动记录"))+"\n                                ")]):[i("a",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["periodic_task_edit"],t.row.auth_actions)},expression:"{ active: !hasPermission(['periodic_task_edit'], props.row.auth_actions) }"}],class:["periodic-pause-btn",{"periodic-start-btn":!t.row.enabled,"text-permission-disable":!e.hasPermission(["periodic_task_edit"],t.row.auth_actions)}],attrs:{href:"javascript:void(0);"},on:{click:function(i){return e.onSetEnable(t.row,i)}}},[e._v("\n                                        "+e._s(t.row.enabled?e.$t("暂停"):e.$t("启动"))+"\n                                    ")]),e._v(" "),i("a",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["periodic_task_edit"],t.row.auth_actions)},expression:"{ active: !hasPermission(['periodic_task_edit'], props.row.auth_actions) }"}],class:["periodic-bk-btn",{"periodic-bk-disable":t.row.enabled,"text-permission-disable":!e.hasPermission(["periodic_task_edit"],t.row.auth_actions)}],attrs:{href:"javascript:void(0);",title:t.row.enabled?e.$t("请暂停任务后再执行编辑操作"):""},on:{click:function(i){return e.onModifyCronPeriodic(t.row,i)}}},[e._v("\n                                        "+e._s(e.$t("编辑"))+"\n                                    ")])],e._v(" "),i("router-link",{attrs:{to:{name:"taskList",params:{project_id:t.row.project.id},query:{template_id:t.row.template_id,create_method:"periodic",create_info:t.row.task.id,template_source:t.row.template_source}}}},[e._v("\n                                    "+e._s(e.$t("执行历史"))+"\n                                ")]),e._v(" "),i("bk-popover",{attrs:{theme:"light",placement:"bottom-start","ext-cls":"common-dropdown-btn-popver","z-index":2e3,distance:0,arrow:!1,"tippy-options":{boundary:"window",duration:[0,0]}}},[i("i",{staticClass:"bk-icon icon-more drop-icon-ellipsis"}),e._v(" "),i("ul",{attrs:{slot:"content"},slot:"content"},[i("li",{staticClass:"opt-btn"},[i("a",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["periodic_task_edit"],t.row.auth_actions)},expression:"{ active: !hasPermission(['periodic_task_edit'], props.row.auth_actions) }"}],class:{disable:t.row.id===e.collectingId||e.collectListLoading,"text-permission-disable":!e.hasPermission(["periodic_task_edit"],t.row.auth_actions)},attrs:{href:"javascript:void(0);"},on:{click:function(i){return e.onCollectTask(t.row,i)}}},[e._v("\n                                                "+e._s(e.isCollected(t.row.id)?e.$t("取消收藏"):e.$t("收藏"))+"\n                                            ")])]),e._v(" "),i("li",{staticClass:"opt-btn"},[i("a",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["periodic_task_delete"],t.row.auth_actions)},expression:"{ active: !hasPermission(['periodic_task_delete'], props.row.auth_actions) }"}],class:{"text-permission-disable":!e.hasPermission(["periodic_task_delete"],t.row.auth_actions)},attrs:{href:"javascript:void(0);"},on:{click:function(i){return e.onDeletePeriodic(t.row,i)}}},[e._v("\n                                                "+e._s(e.$t("删除"))+"\n                                            ")])])])])],2)]}}])}),e._v(" "),i("bk-table-column",{attrs:{type:"setting"}},[i("bk-table-setting-content",{attrs:{fields:e.setting.fieldList,selected:e.setting.selectedFields,size:e.setting.size},on:{"setting-change":e.handleSettingChange}})],1),e._v(" "),i("div",{staticClass:"empty-data",attrs:{slot:"empty"},slot:"empty"},[i("NoData",{attrs:{message:e.$t("无数据")}})],1)],2)],1)],1)]),e._v(" "),i("TaskCreateDialog",{attrs:{entrance:"periodicTask",project_id:e.project_id,"is-new-task-dialog-show":e.isNewTaskDialogShow,"business-info-loading":e.businessInfoLoading,"task-category":e.taskCategory,"dialog-title":e.$t("新建周期任务")},on:{onCreateTaskCancel:e.onCreateTaskCancel}}),e._v(" "),i("ModifyPeriodicDialog",{attrs:{loading:e.modifyDialogLoading,constants:e.constants,cron:e.selectedCron,"task-id":e.selectedPeriodicId,"is-modify-dialog-show":e.isModifyDialogShow},on:{onModifyPeriodicConfirm:e.onModifyPeriodicConfirm,onModifyPeriodicCancel:e.onModifyPeriodicCancel}}),e._v(" "),i("BootRecordDialog",{attrs:{show:e.isBootRecordDialogShow,id:e.selectedPeriodicId},on:{onClose:function(t){e.isBootRecordDialogShow=!1}}}),e._v(" "),i("DeletePeriodicDialog",{attrs:{"is-delete-dialog-show":e.isDeleteDialogShow,"template-name":e.selectedTemplateName,deleting:e.deleting},on:{onDeletePeriodicConfirm:e.onDeletePeriodicConfirm,onDeletePeriodicCancel:e.onDeletePeriodicCancel}})],1)}),[],!1,null,"0d5114d4",null));t.default=W.exports},598:function(e,t,i){"use strict";i.r(t);var a={name:"AdminPeriodic",components:{PeriodicList:i(567).default}},n=i(9),r=Object(n.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"admin-periodic"},[t("periodic-list",{attrs:{admin:!0}})],1)}),[],!1,null,null,null);t.default=r.exports},668:function(e,t,i){i(320)("iterator")},672:function(e,t,i){var a=i(14),n=i(321);a({target:"Array",stat:!0,forced:!i(316)((function(e){Array.from(e)}))},{from:n})},673:function(e,t,i){},727:function(e,t,i){},728:function(e,t,i){var a={"./appmaker-default-icon-1.png":729,"./appmaker-default-icon-2.png":744,"./appmaker-default-icon-3.png":745,"./appmaker-default-icon-4.png":746,"./appmaker-default-icon-5.png":747,"./appmaker-default-icon-6.png":748,"./building.png":733,"./expre_401.png":322,"./expre_403.png":323,"./expre_500.png":324,"./task-en.png":850,"./task-zh.png":851};function n(e){var t=r(e);return i(t)}function r(e){var t=a[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id=728},729:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAnCAYAAAEHsUppAAAABGdBTUEAALGPC/xhBQAABRpJREFUWAntWEtsVkUU/m770ydiaWnVlsJv018spC1ETVQWYkwMEmOQhSZqiJoQjcSFUeMrUTe+FhpJADVqQogLX4lxoyxgQeJCWBBaHgVbxMZWIkgltdiHba/n3PPPnTtzH/+9BBqJTPLf/7zmO2dm7pw5dxz307LXwa1h1R1Y9vhep2OzxzvurrWup7AeZQa/8hWg6wVPJIraZtEffg8YPe7RsVCO55wd5zfsQ2XdRErnykcgEnFeeAy4ZrWIu54v5fwTJ3KAuH2rD+ws3+woJnYYysD+1zNV3w3wTKmm6CaKtftlJUXOp0Z6gLGTwrLxwTeEbrwZ6HnTN8scksy46s8zz42WXYnUCjDvuFEz1P0iULvYs7/g2dEzo/wm/JvGnc9qU6arFmmeKG3M03boXVF20xvK9MQfxjpoYzZzysXY0csgAnlqY16MjieoA4nOHhBtrlYvEkkyLYxGDvqLoaMXJcqYx3Hb+2GNgx20yrRTwi1T2OHuyZJMw0yGCmuzgxc2AjXXhZEiJNEvBGchTjjc1P5kekGBNkgrvQPFbrzJm9cAs9NA7ztsYbTwnKvs0PM24M4Yxl4WOT8M9O8w5cs2AdVNZD9LCeItXxcGZ1XFAmD502KknCinwZHk1wN1K4B/xoAjW3xQRUSDK23wv74LGOkNSkrS6Rc0IzB7Tg9eMs6wgZljlX5+Sysqm9oU6/0H8q4vd5wjzo1PfeXzFpGD675myYC/huQXVCxZvwZV9UEJvR3egeefaKYyy7QceNXu6/Hu0e3fRSpImP5tiUNIkF/SBf0/gbfcnTDLpip+WjqfC6fWxWuBxlt0VlzxDDA/byIGuGhwBi6vBBZSUgq2RTcJ51KK5TavBmh/ONZBGJyLGgY+sw8Y3i0g/CyvEvr3H7RMZUh20HSrlhcpE5xrYy4sps6ZwGzc9oB0OeVXX8IfLObv5rtoS5pnjwnOp8nMOOXzOgJ7UDqrJ59AfBgYjbqvfEkkJz6XEymgN8FZcYiK+Kk/6Uhr1w5qW6TL4DdmVwXc9yHlohMBnZBhcJYf3S4Ohr4Xq+uLU3LumPDek0YxfgZg4MmzAbkm0+WWsgqg9R5g8FvdMwUVHbndcXYqMzBDpAO3naXkL1/w9FVuyqlAC22mpfens3YwjlzFDU5hE52r2drFn/LhPcDAznRRuKjG9NSg2/dRZ7oO2uriB87Yp/dT5bhVe0miXNoM7nSve2zbnUlmti7d3rd7/Qf4SzPjczCwK4HPwSQbLswiwFAlMPyByhX/36cSjEjFJ3rhUW3z8xd0dTegeb5iyV2lL6S0piSVLXAOuO0hqcQYemYCOP4xVQijYUd8+aKqBdbyRYwKOldNd1pPShnIOv7y5kGN/cJcqpYuq9gBM7RdQtru8hvoo7pDpJNUFfZtsy2orFwtVwZKk2EAyYHzReSSexWs/JcKmK0aVlHptE736/uAarERzduUPQDW/0YH2ekfbUufT84qk1QA2uVsZYPU1j6ERVRcbQY9tCs5aC7GahotENo/XHwmtOQZVx35zqX9EarVFyqJvK8nv6aBzWgZUx307vLguI3207v7pdChJwWcv0/uaJSO72oGPoutlJUZ/6cLXPWwB8DfBT/tBKbJITf+wFPfYbxxD2+hgdHGsxt/UrVvpNuq4kxnCFhBZQtc9eIBcAtmk+prKfVRMGXzRNdPAzr/q9BxT77q5W/FpPc/pu+FBR4DNpdietEuz3Yl8Llet38B/GNs9HWJXt8AAAAASUVORK5CYII="},730:function(e,t,i){},731:function(e,t,i){"use strict";i(26),i(38),i(37),i(49),i(50),i(183),i(672),i(187),i(668);var a=i(16),n=i.n(a),r=i(0),o=i.n(r),s=i(5),c=i.n(s),l=i(4),d=i.n(l),u=(i(315),i(128),i(101),i(185),i(23),i(22),i(68),i(39),i(104),i(1)),p=i(7),h=i(655),m=i(28),f=i(676),g=i(611);function v(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw r}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function k(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?k(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):k(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var w={name:"TaskParamEdit",components:{RenderForm:f.a,NoData:g.a},props:{constants:{type:Object,default:function(){return{}}},editable:{type:Boolean,default:!0},showRequired:{type:Boolean,default:!0}},data:function(){return{variables:m.a.deepClone(this.constants),renderOption:{showRequired:!0,showGroup:!0,showLabel:!0,showHook:!1,showDesc:!0,formEdit:this.editable},renderConfig:[],metaConfig:{},renderData:{},initalRenderData:{},isConfigLoading:!0,isNoData:!1}},computed:y(y({},Object(p.e)({atomFormConfig:function(e){return o()(this,void 0),e.atomForm.config}.bind(void 0)})),Object(p.e)("project",{project_id:function(e){return o()(this,void 0),e.project_id}.bind(void 0)})),watch:{constants:function(e){this.variables=m.a.deepClone(e),this.getFormData()},editable:function(e){this.$set(this.renderOption,"editable",e)}},created:function(){this.getFormData(),!1===this.showRequired&&(this.renderOption.showRequired=this.showRequired)},beforeDestroy:function(){this.clearAtomForm()},methods:y(y(y({},Object(p.b)("atomForm/",["loadAtomConfig"])),Object(p.d)("atomForm/",["clearAtomForm"])),{},{getFormData:function(){var e=this;return n()(d.a.mark((function t(){var i,a,n,r,s,c,l=this;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a in i=[],e.renderConfig=[],e.renderData={},e.variables)"show"===(n=m.a.deepClone(e.variables[a])).show_type&&i.push(n);e.isNoData=!i.length,(i=i.sort(function(e,t){return o()(this,l),e.index-t.index}.bind(this))).length>0&&(e.isConfigLoading=!0,e.$emit("onChangeConfigLoading",!0)),r=v(i),t.prev=8,c=d.a.mark((function t(){var i,a,n,r,c,l,p,f,g,v,b=this;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=s.value,a=i.key,n=h.a.getVariableArgs(i),r=n.name,c=n.atom,l=n.tagCode,p=n.classify,f=i.version||"legacy",h.a.isConfigExists(c,f,e.atomFormConfig)){t.next=7;break}return t.next=7,e.loadAtomConfig({name:r,atom:c,classify:p,version:f,project_id:e.project_id});case 7:g=e.atomFormConfig[c][f],(v=m.a.deepClone(h.a.formFilter(l,g)))&&((i.is_meta||v.meta_transform)&&(v=v.meta_transform(i.meta||i),e.metaConfig[a]=m.a.deepClone(i),i.meta||(i.value=v.attrs.value)),v.tag_code=a,v.name=i.name,v.attrs.desc=i.desc,v.hasOwnProperty("events")&&v.events.forEach(function(e){o()(this,b),e.source===l&&(e.source="${"+e.source+"}")}.bind(this)),["input","textarea"].includes(i.custom_type)&&""!==i.validation&&v.attrs.validation.push({type:"regex",args:i.validation,error_message:u.a.t("参数值不符合正则规则：")+i.validation}),e.renderConfig.push(v)),e.renderData[a]=m.a.deepClone(i.value);case 11:case"end":return t.stop()}}),t,this)})),r.s();case 11:if((s=r.n()).done){t.next=15;break}return t.delegateYield(c(),"t0",13);case 13:t.next=11;break;case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(8),r.e(t.t1);case 20:return t.prev=20,r.f(),t.finish(20);case 23:e.initalRenderData=e.renderData,e.$nextTick(function(){o()(this,l),e.isConfigLoading=!1,e.$emit("onChangeConfigLoading",!1)}.bind(this));case 25:case"end":return t.stop()}}),t,this,[[8,17,20,23]])})))()},validate:function(){return!this.isConfigLoading&&this.$refs.renderForm.validate()},judgeDataEqual:function(){return!!this.validate()&&m.a.isDataEqual(this.initalRenderData,this.renderData)},getVariableData:function(){var e=this;return n()(d.a.mark((function t(){var i,a,n,r,o,s,c,l,u,p,f;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.validate()){t.next=3;break}return t.abrupt("return");case 3:i=m.a.deepClone(e.constants),t.t0=d.a.keys(i);case 5:if((t.t1=t.t0()).done){t.next=26;break}if(a=t.t1.value,"hide"!==(n=i[a]).show_type){t.next=22;break}if(!n.is_meta){t.next=20;break}if(r=h.a.getVariableArgs(n),o=r.name,s=r.atom,c=r.tagCode,l=r.classify,u=n.version||"legacy",h.a.isConfigExists(s,u,e.atomFormConfig)){t.next=15;break}return t.next=15,e.loadAtomConfig({name:o,atom:s,classify:l,version:u});case 15:p=e.atomFormConfig[s][u],f=(f=m.a.deepClone(h.a.formFilter(c,p))).meta_transform(n.meta||n),n.meta=m.a.deepClone(n),n.value=f.attrs.value;case 20:t.next=24;break;case 22:n.value=e.renderData[a],n.meta=e.metaConfig[a];case 24:t.next=5;break;case 26:return t.abrupt("return",Promise.resolve(i));case 27:case"end":return t.stop()}}),t)})))()}})},C=(i(743),i(9)),P=Object(C.a)(w,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"task-param-wrapper"},[e.isConfigLoading?e._e():i("RenderForm",{ref:"renderForm",attrs:{scheme:e.renderConfig,"form-option":e.renderOption},model:{value:e.renderData,callback:function(t){e.renderData=t},expression:"renderData"}}),e._v(" "),e.isNoData&&!e.isConfigLoading?i("NoData"):e._e()],1)}),[],!1,null,"71133bc6",null);t.a=P.exports},733:function(e,t,i){e.exports=i.p+"images/building.97ddc3f9f3.png"},743:function(e,t,i){"use strict";i(673)},744:function(e,t){e.exports="data:image/png;base64,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"},745:function(e,t){e.exports="data:image/png;base64,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"},746:function(e,t){e.exports="data:image/png;base64,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"},747:function(e,t){e.exports="data:image/png;base64,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"},748:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAArCAYAAAGm1lB3AAAABGdBTUEAALGPC/xhBQAAB0BJREFUaAXdWWtQlFUY/s7HIrBrioJT6J+EWskQh0a6S2WjXdCaUFTMSc1LmtZYP/rRaEE2/aiccexHTjH5oymTMXWmaaacRMIMcPECKAsIqyMDiMAuKwuLsrun837s+3m+67Ig2XRmlnPOe3ve99y+c14EgSuUUsJ1BbnzZn1RnaP/Ygaj0Lp5JSIvJPR6+6nb42tvdrVRZEiaC1vXSIQPE7Y6Go5cygamxSLmkP5+mjIUGGjv7ukF2s3kpMS4cFsQbTbSQYhQD5wHUmfEM8zacFv2B/ra0js4mDbHsZzCr+VymxskLCh20r5fQAygEfQOOnm/LYJKKgTiYaW3x+1NZJ4JhJCbXd2eOInr6fV5woKC98bAILQ1buXTkpiG6kMBFBSJsKBmXskJ7Gtq8Bxg4be+flcNDCX8MApUUAx8ftdbzReCTY3A/CLlvWkodOyPsin7ig/mYF+E4QbL73R80gDEov49s2Ao3B7vVAiwtu6iNNqUBv5EZHmOQAFHA9qsSPMFDcXIACHaohm5TMeKRipQOxqqyy5RyCgGQJooThiUnK4r0oCgAYU2KCCjo6f7UqxgeRD6bJnJcgoEFIYahXkatGWFha1rT+ffeFvNF8rKT9V+/e0PMjJZ1LqmivUeVUuuOJ5bOzQ0lKmmSyuSjTVd5t0i+bk7sKPGSq1zYfKgHCg5KtXPzn/qbOyE2EckBYnC/vCLHhWAx9PlGFApUi0mTraRyZOsMSgoCuQFGMYwXTZIRHEx0OXxRQWjGvZOY/XP9bgKIu4dzpAhSCEtFA9XO51olNPRbcYI4nPns38q02MagsAmFm4Gm1Hp/bbd7NC8MAf7cHiWTP2crbpYaX2zMfGkzZwxVeZzjRGDoE4oRDvYfk7BPtZmIPIkofB41IpIYIuw40T6EqjBPp64vSlDtNv5SGDr6O0I0IUvycZ1BSehzR9xTiMAECzy7bFfdbfX8EefEQDIBwKhcmfDlTNwLCqORGBCgW25o//Lpo2DBYOwJYep8l/5qJQprFFadqr+oVn2QdiqPB3auiDAUJ3BQMKiC2J2NkvfWNi9+J1FS3p1eGfHM3nWHP4W68khje34XP5ARbpUsyjEXu9AhcvVfvuLq5BQdpg88XoHHC1XOnKVnH+pp1i+ZphzzxSsDoWC34MMEUh5bfbBZ8zkkRcRgDeMSliPBMgQwMwwAmBtBmQIAJ9bd8Bb/apr+zw0pFe/FP905Sbb0seNVo0pABrUA8q1zq/YkJD3BMqMCQCNeILeM9+0Hb613vaabBh5dwQAjPEfZzQOtRHAuB/l4w6gmeQXW9e+HBTorxB2kph4bt/Ez7KgjUU9RNc7u6pqLlx8DPjsXDuxecPrC1BWomGHN4w0rHkgBOANo9ztmpRu2bjqeegTM8O3FYZbAPTu1XW30GM1X9snpdK17jp1V23t2yGFqRUapmQJs89tGlqdBdc9v9/vOPrL77qfXNRPnpZUm5U5J1Nxb9QDQsOyYvgCCn09IDSM8goAJAJQcd+PE8BjpGHNX1iRBkB/VVbHgcdIw1oXAJg4mSiItR6Amfy474PxB4AruiCSlTgEhjURKuC8AfkYkSwzlAsz2DfCAfKKneztG1hJQ/QAyMhzAIZnznhSz2Bf38DSYIge4uXBcFrqdM17SaEPQM2X2/5WEE06ANTiamfXUW1RRKBlj54Cj5ums0cKaCi0k1m5xi6PhaaJgdFDabMSo7XFOx3pAQX3hDsZ1KhnIhqnIw3MWIOKekvDS9LV0+64x+k8D3fKSKMeKQDgMxs5IUE4/kHd3oo6l0t33ZvZiXom1M9hMA6XtE87i+MUz2IzVOCxZ3NuwvzKNQlLkvDpLJFNns9GJu9IEGrjcCHcda14giIo5vTiuJzKN2xLko0SR/+pIPig+Bc4Tzdqm+UYjHSi3hNGhu4m/X8RRFR7YviKKxQmiZMs2xLWWTNi7LMizUA0ywnu2vWNTQmBwFAPS/EUbt6wojySfeCbBoFOmyWGwAjcybdZ19ogCwV9vpgFgU6bJZKGbbE7PIkpMgpKEcRInead1GvzQfFBjNxpPas8jZRaLKQQU3HE56P3dQTaju71fze5IdCSzouOtQ3vj1XBPHpv/JRgRdVZW+f1rtljtcnrT0tOqnl4dnpINwsH75Sv/PsTWVAR1zxvFJxeHcgTVelBTdYO3jWjCQoeWRnp6QF1OlE3CN4xyF12hnpO6wVl4DSvDm1NEGoBo6CMnFbrRwxCrcASpZ5ut3eKhm5MiBgEr2qWV+Xl+HbU3wn23yHFYcAbu1vtqIO4W46a4YpWq3ANHr8jyXybGdLlsXctS5G/Ij2WiVCnKzMGIryDIbuuWRqQVff6/PmE0o8oFTRHosn/DmChVYiUFKamTj9m5Btk4X0+f16Q2WcPCW3Whf8PucoIOM0GvCjt/hQplYdsTRDIwBqCuuHzL2cbeicEpQhiBE6jHaNaHRS/sY2cVtv6B/WRBqiuuRH9AAAAAElFTkSuQmCC"},848:function(e,t,i){"use strict";i(727)},850:function(e,t,i){e.exports=i.p+"images/task-en.f4b2d19a01.png"},851:function(e,t,i){e.exports=i.p+"images/task-zh.a63b7a8c85.png"},852:function(e,t,i){"use strict";i(730)},853:function(e,t,i){},854:function(e,t,i){},855:function(e,t,i){},856:function(e,t,i){},857:function(e,t,i){},858:function(e,t,i){"use strict";i(26),i(38),i(49),i(50);var a=i(51),n=i.n(a),r=i(16),o=i.n(r),s=i(0),c=i.n(s),l=i(5),d=i.n(l),u=i(4),p=i.n(u),h=(i(67),i(127),i(23),i(22),i(37),i(80),i(24),i(83),i(27),i(52),i(1)),m=i(28),f=i(7),g=i(102),v=i(611);function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function k(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var y={name:"TaskCreateDialog",components:{NoData:v.a},mixins:[g.a],props:{isNewTaskDialogShow:Boolean,businessInfoLoading:Boolean,project_id:[Number,String],taskCategory:Array,entrance:String},data:function(){return{selectedTpl:{},taskListPending:!0,searchMode:!1,selectError:!1,commonTplList:[],businessTplList:[],templateList:[],templateType:[{id:"businessProcess",name:h.a.t("项目流程")},{id:"publicProcess",name:h.a.t("公共流程")}],selectedTplType:"businessProcess",selectedTplCategory:"all",selectedTplLabel:[],searchWord:"",nowTypeList:[],templateLabels:[],templateLabelLoading:!1,permissionLoading:!1,hasCommonTplCreateTaskPerm:!0,tplOperations:[],tplResource:{},commonTplOperations:[],commonTplResource:{}}},computed:k(k(k({},Object(f.e)({permissionMeta:function(e){return c()(this,void 0),e.permissionMeta}.bind(void 0)})),Object(f.e)("project/",{projectName:function(e){return c()(this,void 0),e.projectName}.bind(void 0),projectAuthActions:function(e){return c()(this,void 0),e.authActions}.bind(void 0)})),{},{templateCategories:function(){var e=this,t=m.a.deepClone(this.taskCategory);return t.unshift({value:"all",name:h.a.t("全部分类")}),t.map(function(t){return c()(this,e),{value:t.value,name:t.name}}.bind(this))},categoryListPending:function(){return 0!==this.taskCategory.length&&!1===this.taskListPending},isNoData:function(){return 0===this.templateList.length},resource:function(){return"businessProcess"===this.selectedTplType?this.tplResource:this.commonTplResource},action:function(){return"taskflow"===this.entrance?"businessProcess"===this.selectedTplType?["flow_create_task"]:["common_flow_create_task"]:"businessProcess"===this.selectedTplType?["flow_create_periodic_task"]:["common_flow_create_periodic_task"]}}),created:function(){this.onSearchInput=m.a.debounce(this.searchInputhandler,500)},methods:k(k(k(k({},Object(f.b)(["queryUserPermission"])),Object(f.b)("templateList/",["loadTemplateList"])),Object(f.b)("project/",["getProjectLabelsWithDefault"])),{},{getBusinessData:function(){var e=this;return o()(p.a.mark((function t(){var i,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.taskListPending=!0,t.prev=1,t.next=4,e.loadTemplateList({project__id:e.project_id});case 4:i=t.sent,a=i.objects,e.tplOperations=i.meta.auth_operations,e.tplResource=i.meta.auth_resource,e.businessTplList=a,e.templateList=a,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log(t.t0);case 15:return t.prev=15,e.taskListPending=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,12,15,18]])})))()},getcommonData:function(){var e=this;return o()(p.a.mark((function t(){var i,a,n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.taskListPending=!0,i={common:1},t.prev=2,t.next=5,e.loadTemplateList(i);case 5:a=t.sent,n=a.objects,e.commonTplOperations=a.meta.auth_operations,e.commonTplResource=a.meta.auth_resource,e.commonTplList=e.getGroupedList(n),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0);case 15:return t.prev=15,e.taskListPending=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))()},getTemplateLabelList:function(){var e=this;return o()(p.a.mark((function t(){var i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.templateLabelLoading=!0,t.next=4,e.getProjectLabelsWithDefault(e.project_id);case 4:i=t.sent,e.templateLabels=i.data,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:return t.prev=11,e.templateLabelLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()},getGroupedList:function(e){var t=this,i=[],a=[];return this.taskCategory.forEach(function(e){c()(this,t),i.push(e.name),a.push({id:e.value,name:e.name,children:[]})}.bind(this)),e.forEach(function(e){c()(this,t);var n=e.category_name,r=i.indexOf(n);r>-1&&a[r].children.push({id:e.id,name:e.name,project:e.project,auth_actions:e.auth_actions})}.bind(this)),a.filter(function(e){return c()(this,t),e.children.length}.bind(this))},toggleShow:function(e){var t=this;return o()(p.a.mark((function i(){return p.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=5;break}return t.getTemplateLabelList(),i.next=4,t.getBusinessData();case 4:t.onFiltrationTemplate();case 5:case"end":return i.stop()}}),i)})))()},onCreateTask:function(){if("number"==typeof this.selectedTpl.id){if(!this.permissionLoading)if(this.hasCommonTplCreateTaskPerm){var e={name:"taskCreate",params:{project_id:this.project_id,step:"selectnode"},query:{template_id:this.selectedTpl.id,common:"publicProcess"===this.selectedTplType?"1":void 0,entrance:this.entrance||void 0}};this.$router.push(e)}else this.applyCommonTplCreateTaskPerm()}else this.selectError=!0},onCancel:function(){this.selectedTplType="businessProcess",this.selectedTplCategory="all",this.selectedTpl={},this.selectError=!1,this.selectedTplLabel=[],this.$emit("onCreateTaskCancel")},onSelectTpl:function(e){if("businessProcess"===this.selectedTplType)if(this.hasPermission(this.action,e.auth_actions))this.selectError=!1,this.selectedTpl=e;else{var t={flow:[{id:e.id,name:e.name}],project:[{id:e.project.id,name:e.project.name}]};this.applyForPermission(this.action,e.auth_actions,t)}else this.selectError=!1,this.selectedTpl=e,this.checkCommonTplPermission(e)},checkCommonTplPermission:function(e){var t=this;return o()(p.a.mark((function i(){var a,n,r,o=this;return p.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,t.permissionLoading=!0,a=t.permissionMeta.system.find(function(e){return c()(this,o),"bk_sops"===e.id}.bind(this)),n={action:"taskflow"===t.entrance?"common_flow_create_task":"common_flow_create_periodic_task",resources:[{system:a.id,type:"project",id:t.project_id,attributes:{}},{system:a.id,type:"common_flow",id:e.id,attributes:{}}]},i.next=6,t.queryUserPermission(n);case 6:r=i.sent,t.hasCommonTplCreateTaskPerm=r.data.is_allow,i.next=13;break;case 10:i.prev=10,i.t0=i.catch(0),console.log(i.t0);case 13:return i.prev=13,t.permissionLoading=!1,i.finish(13);case 16:case"end":return i.stop()}}),i,this,[[0,10,13,16]])})))()},applyCommonTplCreateTaskPerm:function(){var e="taskflow"===this.entrance?["common_flow_create_task"]:["common_flow_create_periodic_task"],t=[].concat(n()(this.selectedTpl.auth_actions),n()(this.projectAuthActions)),i={common_flow:[{id:this.selectedTpl.id,name:this.selectedTpl.name}],project:[{id:this.project_id,name:this.projectName}]};this.applyForPermission(e,t,i)},searchInputhandler:function(){var e=this,t=[],i=new RegExp(this.searchWord,"i"),a=m.a.deepClone(this.nowTypeList);t="publicProcess"===this.selectedTplType?a.filter(function(t){var a=this;return c()(this,e),t.children=t.children.filter(function(e){return c()(this,a),i.test(e.name)}.bind(this)),t.children.length}.bind(this)):a.filter(function(t){return c()(this,e),i.test(t.name)}.bind(this)),this.templateList=t},onChooseTplType:function(e){var t=this;return o()(p.a.mark((function i(){return p.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t.selectedTplType=e,t.selectedTpl={},t.templateList=[],t.searchWord="","businessProcess"!==e){i.next=10;break}return t.selectedTplLabel=[],i.next=8,t.getBusinessData();case 8:i.next=13;break;case 10:return t.selectedTplCategory="all",i.next=13,t.getcommonData();case 13:t.onFiltrationTemplate();case 14:case"end":return i.stop()}}),i)})))()},onLabelChange:function(){this.onFiltrationTemplate()},onChooseTplCategory:function(e){this.selectedTplCategory=e,this.selectedTpl={},this.onFiltrationTemplate()},onFiltrationTemplate:function(){var e=this,t="businessProcess"===this.selectedTplType?this.businessTplList:this.commonTplList,i=m.a.deepClone(t);"businessProcess"===this.selectedTplType?i=i.filter(function(t){var i=this;return c()(this,e),this.selectedTplLabel.every(function(e){var a=this;return c()(this,i),t.template_labels.find(function(t){return c()(this,a),t.label_id===Number(e)}.bind(this))}.bind(this))}.bind(this)):"all"!==this.selectedTplCategory&&(i=i.filter(function(t){return c()(this,e),t.id===this.selectedTplCategory}.bind(this))),this.templateList=i,this.nowTypeList=i,""!==this.searchWord&&this.searchInputhandler()}})},w=(i(848),i(9)),C=Object(w.a)(y,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("bk-dialog",{staticClass:"new-task-dialog",attrs:{width:"850","ext-cls":"common-dialog",theme:"primary","mask-close":!1,"header-position":"left",title:e.$t("新建任务"),value:e.isNewTaskDialogShow,"auto-close":!1},on:{"value-change":e.toggleShow}},[i("div",{staticClass:"task-container"},[i("div",{staticClass:"task-wrapper"},[i("div",{staticClass:"filtrate-wrapper"},[i("div",{staticClass:"task-search"},[i("bk-select",{staticClass:"bk-select-inline",attrs:{value:e.selectedTplType,"popover-width":260,disabled:!e.categoryListPending,clearable:!1},on:{selected:e.onChooseTplType}},e._l(e.templateType,(function(e,t){return i("bk-option",{key:t,attrs:{id:e.id,name:e.name}})})),1)],1),e._v(" "),i("div",{staticClass:"task-search"},["publicProcess"===e.selectedTplType?i("bk-select",{staticClass:"bk-select-inline",attrs:{value:e.selectedTplCategory,"popover-width":260,disabled:!e.categoryListPending,clearable:!1},on:{selected:e.onChooseTplCategory}},e._l(e.templateCategories,(function(e,t){return i("bk-option",{key:t,attrs:{id:e.value,name:e.name}})})),1):i("bk-select",{key:"label-select",staticClass:"bk-select-inline",attrs:{"ext-popover-cls":"label-select",placeholder:e.$t("请选择标签"),"popover-width":260,"display-tag":!0,multiple:!0},on:{change:e.onLabelChange},model:{value:e.selectedTplLabel,callback:function(t){e.selectedTplLabel=t},expression:"selectedTplLabel"}},e._l(e.templateLabels,(function(t,a){return i("bk-option",{key:a,attrs:{id:t.id,name:t.name}},[i("div",{staticClass:"label-select-option"},[i("span",{staticClass:"label-select-color",style:{background:t.color}}),e._v(" "),i("span",[e._v(e._s(t.name))]),e._v(" "),i("i",{staticClass:"bk-option-icon bk-icon icon-check-1"})])])})),1)],1),e._v(" "),i("div",{staticClass:"task-search"},[i("bk-input",{staticClass:"search-input",attrs:{placeholder:e.$t("请输入关键字"),"right-icon":"bk-icon icon-search",clearable:!0},on:{input:e.onSearchInput},model:{value:e.searchWord,callback:function(t){e.searchWord="string"==typeof t?t.trim():t},expression:"searchWord"}})],1)]),e._v(" "),i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.taskListPending,opacity:1,zIndex:100},expression:"{ isLoading: taskListPending, opacity: 1, zIndex: 100 }"}],staticClass:"task-list"},[e.isNoData?i("NoData",{staticClass:"empty-task"},[e._v(e._s(e.$t("搜索结果为空")))]):i("ul",{staticClass:"grouped-list"},["publicProcess"===e.selectedTplType?[e._l(e.templateList,(function(t){return[t.children.length?i("li",{key:t.id,staticClass:"task-group"},[i("h5",{staticClass:"task-name"},[e._v("\n                                    "+e._s(t.name)+"\n                                    ("),i("span",{staticClass:"list-count"},[e._v(e._s(t.children.length))]),e._v(")\n                                ")]),e._v(" "),i("ul",e._l(t.children,(function(t){return i("li",{key:t.id,class:["task-item",{"task-item-selected":e.selectedTpl.id===t.id,"permission-disable":"businessProcess"===e.selectedTplType&&!e.hasPermission(e.action,t.auth_actions)}],attrs:{title:t.name},on:{click:function(i){return e.onSelectTpl(t)}}},[i("div",{staticClass:"task-item-icon"},[e._v(e._s(t.name.substr(0,1).toUpperCase()))]),e._v(" "),i("div",{staticClass:"task-item-name-box"},[i("div",{staticClass:"task-item-name"},[e._v(e._s(t.name))])]),e._v(" "),i("div",{staticClass:"apply-permission-mask"},[i("bk-button",{attrs:{theme:"primary",size:"small"}},[e._v(e._s(e.$t("申请权限")))])],1)])})),0)]):e._e()]}))]:e._l(e.templateList,(function(t){return i("li",{key:t.id,class:["task-item",{"task-item-selected":e.selectedTpl.id===t.id,"permission-disable":"businessProcess"===e.selectedTplType&&!e.hasPermission(e.action,t.auth_actions)}],attrs:{title:t.name},on:{click:function(i){return e.onSelectTpl(t)}}},[i("div",{staticClass:"task-item-icon"},[e._v(e._s(t.name.substr(0,1).toUpperCase()))]),e._v(" "),i("div",{staticClass:"task-item-name-box"},[i("div",{staticClass:"task-item-name"},[e._v(e._s(t.name))])]),e._v(" "),i("div",{staticClass:"apply-permission-mask"},[i("bk-button",{attrs:{theme:"primary",size:"small"}},[e._v(e._s(e.$t("申请权限")))])],1)])}))],2)],1)]),e._v(" "),e.selectError?i("div",{staticClass:"task-footer"},[i("span",{staticClass:"error-info"},[e._v(e._s(e.$t("请选择流程模版")))])]):e._e()]),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:"publicProcess"===e.selectedTplType&&!e.hasCommonTplCreateTaskPerm},expression:"{\n                active: selectedTplType === 'publicProcess' && !hasCommonTplCreateTaskPerm\n            }"}],class:{"btn-permission-disable":"publicProcess"===e.selectedTplType&&!e.hasCommonTplCreateTaskPerm},attrs:{theme:"primary",loading:e.permissionLoading},on:{click:e.onCreateTask}},[e._v("\n            "+e._s(e.$t("确定"))+"\n        ")]),e._v(" "),i("bk-button",{on:{click:e.onCancel}},[e._v(e._s(e.$t("取消")))])],1)])}),[],!1,null,"08a82b04",null);t.a=C.exports},860:function(e,t,i){"use strict";var a=i(51),n=i.n(a),r=i(0),o=i.n(r),s=(i(27),i(70),i(82),i(67),i(22),i(68),i(24),i(127),i(37),i(81),i(1)),c=i(6),l=i(28),d=[{key:"min",title:s.a.tc("分钟",0),radio:0,long:60,max:59,loop:{start:0,inter:1,reg:{required:!0,regex:/^([0-9]|0[1-9]|[0-5][0-9])$/}}},{key:"hour",title:s.a.tc("小时",0),radio:0,long:24,max:23,loop:{start:0,inter:1,reg:{required:!0,regex:/^([0-9]|0[1-9]|[0-1][0-9]|20|21|23)$/}}},{key:"week",title:s.a.t("星期"),radio:0,long:7,max:6,loop:{start:0,inter:1,reg:{required:!0,regex:/^[0-6]$/}}},{key:"day",title:s.a.t("日期"),radio:0,long:31,max:31,loop:{start:1,inter:1,reg:{required:!0,regex:/^([1-9]|0[1-9]|1[0-9]|2[0-9]|30|31)$/}}},{key:"month",title:s.a.t("月份"),radio:0,long:12,max:12,loop:{start:1,inter:1,reg:{required:!0,regex:/^([1-9]|0[1-9]|10|11|12)$/}}}],u=["min","hour","week"],p=["day","month"],h={loop:{name:s.a.t("循环"),start:s.a.t("从第"),startWeek:s.a.t("从星期"),center:s.a.t("开始，每隔"),end:s.a.t("执行一次")},appoint:{name:s.a.t("指定")}},m={1:s.a.t("星期一"),2:s.a.t("星期二"),3:s.a.t("星期三"),4:s.a.t("星期四"),5:s.a.t("星期五"),6:s.a.t("星期六"),0:s.a.t("星期天")},f={name:"loopRuleSelect",filters:{addZero:function(e,t){return"week"===t?e:e<10?"0"+e:e}},props:{manualInputValue:{type:String,default:"*/5 * * * *"}},data:function(){return{periodicRule:{required:!0,regex:c.h},expressionList:["*","*","*","*","*"],periodicCronImg:i(728)("./"+s.a.t("task-zh")+".png"),autoRuleList:[],autoWay:h,currentWay:"selectGeneration",currentRadio:"loop",tabName:"min",tName:"",periodicCron:"",templateNameRule:"",ruleTipsHtmlConfig:{allowHtml:!0,width:560,trigger:"mouseenter",theme:"light",content:"#periodic-cron-tips-html",placement:"top"}}},computed:{expressionShowText:function(){return this.expressionList.join("^").replace(/\^/g," ")}},watch:{manualInputValue:{handler:function(e){this.periodicCron=e,this.setValue(e)},immediate:!0}},created:function(){this.autoRuleList=l.a.deepClone(d),this.initializeAutoRuleListData(),this.renderRule()},methods:{onSwitchWay:function(e){this.currentWay=e},tabChanged:function(e){this.tabName=e},onAutoWaySwitch:function(e,t){this.$set(this.autoRuleList[e],"radio",Number(t)),this.renderRule()},initializeAutoRuleListData:function(){var e=this;this.autoRuleList.forEach(function(t,i){o()(this,e);for(var a=[],n=0;n<t.long;n++){var r=p.includes(t.key)?n+1:n;a.push({name:"".concat(t.key).concat(n),checked:!0,v:n,value:"week"!==t.key?r:m[r]})}this.$set(this.autoRuleList[i],"checkboxList",a)}.bind(this))},clearRule:function(){var e=this;this.autoRuleList.forEach(function(t,i){var a=this;o()(this,e),t.checkboxList.forEach(function(e,t){o()(this,a),e.checked=!1}.bind(this)),t.loop.start=u.includes(t.key)?0:1,t.loop.inter=1}.bind(this)),this.renderRule()},renderRule:function(){var e=this;this.autoRuleList.map(function(t,i){var a=this;o()(this,e);var n=t.radio,r=t.loop,s=t.checkboxList,c=t.max,l="";r.start===(u.includes(t.key)?0:1)?(l="*/".concat(r.inter),1===r.inter&&(l="*")):l="".concat(r.start,"-").concat(c,"/").concat(r.inter);var d=s.filter(function(e){return o()(this,a),e.checked}.bind(this)).map(function(e){return o()(this,a),p.includes(t.key)?e.v+1:e.v}.bind(this)).join(",")||"*",h=0===n?l:d;this.$set(this.expressionList,i,h)}.bind(this))},mergeCloseNumber:function(e){var t=this;if(Array.isArray(e)){for(var i=[],a=[],r=function(t){var r=this;if(i.some(function(i){return o()(this,r),i===e[t]}.bind(this)))return"continue";var s=[],c=e[t];s.push(e[t]);for(var l=t+1;l<e.length&&c+1===e[l];l++)s.push(e[l]),c=e[l];a.push(s),i=[].concat(n()(i),s)},s=0;s<e.length;s++)r(s);return a.map(function(e){return o()(this,t),e.length>1?"".concat(e[0],"-").concat(e[e.length-1],"/1"):"".concat(e[0])}.bind(this))}return e},validationExpression:function(){var e=this,t=!0;return this.autoRuleList.forEach(function(i){o()(this,e),this.$validator.errors.has(i.key+"Rule")&&"selectGeneration"===this.currentWay&&(this.tabName=i.key,t=!1)}.bind(this)),"manualInput"===this.currentWay&&this.$validator.errors.has("periodicCron")&&(this.currentWay="manualInput",t=!1),{check:t,rule:"manualInput"===this.currentWay?this.periodicCron:this.expressionShowText}},setValue:function(e){var t=this;this.$nextTick(function(){var i=this;o()(this,t),e.split(" ").forEach(function(e,t){var a=this;o()(this,i);var n=this.autoRuleList[t];"*"===e?(n.radio=0,n.checkboxList.forEach(function(e){o()(this,a),e.checked=!0}.bind(this))):-1!==e.indexOf("/")&&1*e.split("/")[0].split("-")[1]===n.max?(n.radio=0,n.loop.start=1*e.split("/")[0].split("-")[0],n.loop.inter=1*e.split("/")[1]):-1!==e.indexOf("*/")?(n.radio=0,n.loop.start=u.includes(n.key)?0:1,n.loop.inter=1*e.split("/")[1]):/[^(\d{1,2},)]|[^(\d{1,2})]/g.test(e)?this.currentWay="manualInput":(n.radio=1,n.checkboxList.forEach(function(t,i){var r=this;o()(this,a),t.checked=e.split(",").some(function(e){return o()(this,r),p.includes(n.key)?1*e-1==1*t.v:1*e==1*t.v}.bind(this))}.bind(this)))}.bind(this)),this.renderRule()}.bind(this))}}},g=(i(852),i(9)),v=Object(g.a)(f,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"loop-rule-select"},[i("div",{staticClass:"loop-rule-title bk-button-group"},[i("bk-button",{staticClass:"rule-btn",attrs:{theme:"selectGeneration"===e.currentWay?"primary":"default"},on:{click:function(t){return e.onSwitchWay("selectGeneration")}}},[e._v("\n            "+e._s(e.$t("选择生成"))+"\n        ")]),e._v(" "),i("bk-button",{staticClass:"rule-btn",attrs:{theme:"manualInput"===e.currentWay?"primary":"default"},on:{click:function(t){return e.onSwitchWay("manualInput")}}},[e._v("\n            "+e._s(e.$t("手动输入"))+"\n        ")])],1),e._v(" "),i("div",{staticClass:"content-wrapper"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"selectGeneration"===e.currentWay,expression:"currentWay === 'selectGeneration'"}],staticClass:"selected-input"},[i("bk-input",{attrs:{value:e.expressionShowText,disabled:!0}}),e._v(" "),i("span",{staticClass:"clear-selected",on:{click:function(t){return t.stopPropagation(),e.clearRule.apply(null,arguments)}}},[e._v("\n                "+e._s(e.$t("清空"))+"\n            ")])],1),e._v(" "),i("bk-tab",{directives:[{name:"show",rawName:"v-show",value:"selectGeneration"===e.currentWay,expression:"currentWay === 'selectGeneration'"}],attrs:{type:"border-card",active:e.tabName},on:{"tab-changed":e.tabChanged}},e._l(e.autoRuleList,(function(t,a){return i("bk-tab-panel",{key:a,attrs:{name:t.key,label:t.title}},[i("div",{staticClass:"tabpanel-container"},[i("bk-radio-group",{on:{change:e.renderRule},model:{value:t.radio,callback:function(i){e.$set(t,"radio",i)},expression:"item.radio"}},[i("bk-radio",{attrs:{value:0}},[e._v(e._s(e.autoWay.loop.name))]),e._v(" "),i("bk-radio",{attrs:{value:1}},[e._v(e._s(e.autoWay.appoint.name))])],1),e._v(" "),0===t.radio?i("div",{staticClass:"loop-select-bd"},[e._v("\n                        "+e._s("week"!==t.key?e.autoWay.loop.start:e.autoWay.loop.startWeek)+"\n                        "),i("bk-input",{directives:[{name:"validate",rawName:"v-validate",value:t.loop.reg,expression:"item.loop.reg"}],staticClass:"loop-time",attrs:{name:t.key+"Rule"},on:{blur:function(t){return e.renderRule()}},model:{value:t.loop.start,callback:function(i){e.$set(t.loop,"start",e._n(i))},expression:"item.loop.start"}}),e._v("\n                        "+e._s("week"!==t.key?t.title:"")+e._s(e.autoWay.loop.center)+"\n                        "),i("bk-input",{directives:[{name:"validate",rawName:"v-validate",value:{required:!0,integer:!0},expression:"{ required: true, integer: true }"}],staticClass:"loop-time",attrs:{name:"interval"},on:{blur:function(t){return e.renderRule()}},model:{value:t.loop.inter,callback:function(i){e.$set(t.loop,"inter",e._n(i))},expression:"item.loop.inter"}}),e._v("\n                        "+e._s("week"!==t.key?t.title:e.$tc("天",0))+e._s(e.autoWay.loop.end)+"\n                        "),e._v(" "),"week"===t.key?i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.$t("0 表示星期天，6 表示星期六"),expression:"$t('0 表示星期天，6 表示星期六')"}],staticClass:"common-icon-info month-tips top-start"}):e._e(),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.veeErrors.has(t.key+"Rule")||e.veeErrors.has("interval"),expression:"veeErrors.has(item.key + 'Rule') || veeErrors.has('interval')"}],staticClass:"local-error-tip error-msg"},[e._v("\n                            "+e._s(e.veeErrors.first(t.key+"Rule")||e.veeErrors.first("interval"))+"\n                        ")])],1):i("div",{staticClass:"appoint-select-bd"},e._l(t.checkboxList,(function(a,n){return i("bk-checkbox",{key:n,on:{change:e.renderRule},model:{value:a.checked,callback:function(t){e.$set(a,"checked",t)},expression:"box.checked"}},[e._v("\n                            "+e._s(e._f("addZero")(a.value,t.key))+"\n                        ")])})),1)],1)])})),1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"manualInput"===e.currentWay,expression:"currentWay === 'manualInput'"}],staticClass:"hand-input"},[i("bk-input",{directives:[{name:"validate",rawName:"v-validate",value:{required:!0,cronRlue:!0},expression:"{ required: true, cronRlue: true }"}],staticClass:"step-form-content-size",attrs:{clearable:!0,name:"periodicCron"},model:{value:e.periodicCron,callback:function(t){e.periodicCron=t},expression:"periodicCron"}})],1)],1),e._v(" "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.ruleTipsHtmlConfig,expression:"ruleTipsHtmlConfig"}],staticClass:"common-icon-info rule-tips"}),e._v(" "),i("div",{attrs:{id:"periodic-cron-tips-html"}},[i("img",{staticClass:"ui-img",staticStyle:{width:"100%"},attrs:{src:e.periodicCronImg}})]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.veeErrors.has("periodicCron")&&"manualInput"===e.currentWay,expression:"veeErrors.has('periodicCron') && currentWay === 'manualInput'"}],staticClass:"common-error-tip error-msg"},[e._v("\n        "+e._s(e.veeErrors.first("periodicCron"))+"\n    ")])])}),[],!1,null,"222f67b4",null);t.a=v.exports},979:function(e,t,i){"use strict";i(853)},980:function(e,t,i){"use strict";i(854)},981:function(e,t,i){"use strict";i(855)},982:function(e,t,i){"use strict";i(856)},983:function(e,t,i){"use strict";i(857)}}]);